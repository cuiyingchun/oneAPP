(function(){GeoBOS=GeoBOS||{};GeoBOS.wifi=GeoBOS.wifi||function(){var setWifiEnabled,isWifiEnabled,scan,getScanResults,connect,isConnected,disconnect,getConnectionInfo,onWifiEnabled,onWifiConnected,constants;var WifiManager=atelier.wifi;setWifiEnabled=function(enabled,callback){WifiManager.isActivated(function(isActivated){if(isActivated&&!enabled){return WifiManager.deactivate(function(isDeactivateSuccessed){if(isDeactivateSuccessed){callback(null)}else{callback(new Error("set wifi disabled failed"))}})}if(!isActivated&&enabled){return WifiManager.activate(function(isActivateSuccessed){if(isActivateSuccessed){callback(null)}else{callback(new Error("set wifi enabled failed"))}})}callback(new Error("wifi has been "+(enabled?"enabled":"disabled")))})};isWifiEnabled=function(callback){WifiManager.isActivated(function(isActivated){callback(null,isActivated)})};scan=function(callback){WifiManager.scan(function(isScanSuccessed){if(isScanSuccessed){callback(null)}else{callback(new Error("scan wifi failed"))}})};getScanResults=function(callback){WifiManager.wifi.getSystemScanResult(function(scanResults){callback(null,scanResults)})};connect=function(options,callback){var ssid=options.ssid||"";var password=options.password||"";var authType=options.authType||constants.AUTHTYPE_WPA2_PSK;WifiManager.connect(ssid,authType,password,function(isConnectedSuccessed){if(isConnectedSuccessed){callback(null)}else{callback(new Error("connect failed"))}})};isConnected=function(callback){WifiManager.isConnected(function(isConnected){callback(null,isConnected)})};disconnect=function(callback){WifiManager.isConnected(function(isConnected){if(!isConnected){return callback(new Error("wifi is not connected"))}WifiManager.getConnectionTargetInfo(function(connectionTargetInfo){var connectedSSID=connectionTargetInfo.ssid;WifiManager.disconnect(connectedSSID,function(isDisconnectedSuccessed){if(isDisconnectedSuccessed){callback(null)}else{callback(new Error("disconnect failed"))}})})})};getConnectionInfo=function(callback){WifiManager.isConnected(function(isConnected){if(!isConnected){return callback(null,null)}else{WifiManager.getConnectionTargetInfo(function(connectionTargetInfo){callback(null,connectionTargetInfo)})}})};onWifiEnabled=function(){var addListener,removeListener;var _listenerMap={};var _counter=0;function _wifiEnabled(){for(var key in _listenerMap){if(_listenerMap.hasOwnProperty){_listenerMap[key](true)}}}function _wifiDisabled(){for(var key in _listenerMap){if(_listenerMap.hasOwnProperty(key)){_listenerMap[key](false)}}}WifiManager.onActivated.addListener(_wifiEnabled);WifiManager.onDeactivated.addListener(_wifiDisabled);addListener=function(listener){_listenerMap[++_counter]=listener};removeListener=function(listener){if("undefined"!==typeof listener){for(var key in _listenerMap){if(_listenerMap.hasOwnProperty(key)&&_listenerMap[key]===listener){delete _listenerMap[key]}}}else{_listenerMap={};_counter=0}};return{addListener:addListener,removeListener:removeListener}}();onWifiConnected=function(){var addListener,removeListener;var _listenerMap={};var _counter=0;function _wifiConnected(resultCode,bssInfo){console.log("wifi connectd event:"+resultCode);if(resultCode===0){for(var key in _listenerMap){if(_listenerMap.hasOwnProperty){_listenerMap[key](true)}}}}function _wifiDisconnected(isDisconnected,bssInfo){if(isDisconnected){for(var key in _listenerMap){if(_listenerMap.hasOwnProperty(key)){_listenerMap[key](false)}}}}WifiManager.onConnected.addListener(_wifiConnected);WifiManager.onDisconnected.addListener(_wifiDisconnected);addListener=function(listener){_listenerMap[++_counter]=listener};removeListener=function(listener){if("undefined"!==typeof listener){for(var key in _listenerMap){if(_listenerMap.hasOwnProperty(key)&&_listenerMap[key]===listener){delete _listenerMap[key]}}}else{_listenerMap={};_counter=0}};return{addListener:addListener,removeListener:removeListener}}();constants={AUTHTYPE_WPA2_PSK:5,AUTHTYPE_WPA_PSK:5};return{setWifiEnabled:setWifiEnabled,isWifiEnabled:isWifiEnabled,scan:scan,getScanResults:getScanResults,connect:connect,isConnected:isConnected,disconnect:disconnect,getConnectionInfo:getConnectionInfo,onWifiEnabled:onWifiEnabled,onWifiConnected:onWifiConnected,constants:constants}}()})(GeoBOS);