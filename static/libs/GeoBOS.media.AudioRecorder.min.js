!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var n=r();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(){return function(e){function r(o){if(n[o])return n[o].exports;var t=n[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n={};return r.m=e,r.c=n,r.i=function(e){return e},r.d=function(e,n,o){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=0)}([function(e,r,n){"use strict";!function(e){e.GeoBOS=e.GeoBOS||{},e.GeoBOS.media=e.GeoBOS.media||{},e.GeoBOS.media.AudioRecorder=function(){function e(r){o(new Error(r+"")),null!==n&&atelier.audiorecorder.release().then(function(){n=null,a=null,l=!1,d=null,f=null,s=0,p=0,atelier.audiorecorder.onRecordingListener.removeListener(e)}).catch(function(e){})}function r(r){r=r||function(){},null===n?atelier.audiorecorder.create().then(function(){n="ready",atelier.audiorecorder.onRecordingListener.addListener(e),r(null,h)}).catch(function(e){r(new Error("create audio recorder failed:"+JSON.stringify(e)))}):r(null,h)}var n=null,o=function(){},t=function(){},u=function(){},i=function(){},c=function(){},a=null,l=!1,d=null,f=null,s=0,p=0,h={record:function(){"ready"===n&&atelier.audiorecorder.start({audioSource:"MIC",outputFormat:"AAC_ADTS",audioEncoder:"AAC"}).then(function(r){""===r?(e("audio recorder start error"),a=null):(n="recording",t(),a=r.replace("/storage/emulated/0",""),setTimeout(function(){l=!0},3e3))}).catch(function(r){e("start audio error:"+r.errorCode)})},pause:function(){function r(){clearInterval(f),f=null,p=0,atelier.audiorecorder.pause().then(function(){n="pause",u()}).catch(function(r){e("pause audio error:"+r.errorCode)})}"recording"===n&&(l?r():f||(f=setInterval(function(){(p++>3||l)&&r()},1e3)))},resume:function(){"pause"===n&&atelier.audiorecorder.resume().then(function(){n="recording",i()}).catch(function(r){e("resume audio error:"+r.errorCode)})},stop:function(){function r(){clearInterval(d),d=null,s=0,atelier.audiorecorder.stop().then(function(){c(a),atelier.audiorecorder.release().then(function(){n=null}).catch(function(r){e("release audio error:"+r.errorCode)})}).catch(function(r){e("stop audio error:"+r.errorCode)})}"recording"===n||"pause"===n?l?r():d||(d=setInterval(function(){(s++>3||l)&&r()},1e3)):"ready"===n&&atelier.audiorecorder.release().then(function(){n=null}).catch(function(r){e("release audio error:"+r.errorCode)})},on:function(e,r){switch(e){case"start":t=r;break;case"stop":c=r;break;case"pause":u=r;break;case"resume":i=r;break;case"error":o=r}}};return{getInstance:r}}()}(window)}])});