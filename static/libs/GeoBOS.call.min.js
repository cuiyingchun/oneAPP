!function(l,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var a=e();for(var n in a)("object"==typeof exports?exports:l)[n]=a[n]}}(this,function(){return function(l){function e(n){if(a[n])return a[n].exports;var c=a[n]={i:n,l:!1,exports:{}};return l[n].call(c.exports,c,c.exports,e),c.l=!0,c.exports}var a={};return e.m=l,e.c=a,e.i=function(l){return l},e.d=function(l,a,n){e.o(l,a)||Object.defineProperty(l,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(l){var a=l&&l.__esModule?function(){return l.default}:function(){return l};return e.d(a,"a",a),a},e.o=function(l,e){return Object.prototype.hasOwnProperty.call(l,e)},e.p="",e(e.s=0)}([function(l,e,a){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(l){return typeof l}:function(l){return l&&"function"==typeof Symbol&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l};!function(l){l.GeoBOS=l.GeoBOS||{},l.GeoBOS.call=function(){function l(l){return/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(l)}function e(l){if(console.log("----------action-----------"),"object"===(void 0===l?"undefined":n(l))&&l.appid&&l.type)switch(console.log("----------------recevie ation-------------"),l.type){case A.CALLBACK_ID.uaCallbackCallAccept:console.log("----------call accept-------------"),"function"==typeof A.LISTENER_FUNC.callAccept_listener&&A.LISTENER_FUNC.callAccept_listener();break;case A.CALLBACK_ID.uaCallbackCallBusy:console.log("----------call busy-------------"),"function"==typeof A.LISTENER_FUNC.callBusy_listener&&A.LISTENER_FUNC.callBusy_listener();break;case A.CALLBACK_ID.uaCallbackCallCancel:console.log("----------call cancel-------------"),"function"==typeof A.LISTENER_FUNC.callCancel_listener&&A.LISTENER_FUNC.callCancel_listener();break;case A.CALLBACK_ID.uaCallbackCallEnd:console.log("----------call end-------------"),"function"==typeof A.LISTENER_FUNC.callEnd_listener&&A.LISTENER_FUNC.callEnd_listener();break;case A.CALLBACK_ID.uaCallbackCalling:console.log("----------call calling-------------"),"function"==typeof A.LISTENER_FUNC.callCalling_listener&&A.LISTENER_FUNC.callCalling_listener();break;case A.CALLBACK_ID.uaCallbackCallReject:console.log("----------call reject-------------"),"function"==typeof A.LISTENER_FUNC.callReject_listener&&A.LISTENER_FUNC.callReject_listener();break;case A.CALLBACK_ID.uaCallbackCallTimeout:console.log("----------call timeout-------------"),"function"==typeof A.LISTENER_FUNC.callTimeout_listener&&A.LISTENER_FUNC.callTimeout_listener();break;case A.CALLBACK_ID.uaCallbackIncomingCall:console.log("----------call incoming call-------------"),"function"==typeof A.LISTENER_FUNC.callIncoming_listener&&l.extras.ip&&A.LISTENER_FUNC.callIncoming_listener(l.extras.ip);break;default:console.log("----------action type not exits-------------")}}function a(){console.log("-----------onBackground-----------"),atelier.appman.extendBackgroundDuration(0)}function c(l){switch(console.log("-------ret-----------"+JSON.stringify(l)),l.extras.type){case A.ACTIONS.uaCall:"function"==typeof A.CALLBACK_FUNC.makeCall_cb&&A.CALLBACK_FUNC.makeCall_cb(l.extras.result);break;case A.ACTIONS.uaHangup:"function"==typeof A.CALLBACK_FUNC.hangUpCall_cb&&A.CALLBACK_FUNC.hangUpCall_cb(l.extras.result);break;case A.ACTIONS.uaAnswer:"function"==typeof A.CALLBACK_FUNC.answerCall_cb&&A.CALLBACK_FUNC.answerCall_cb(l.extras.result);break;case A.ACTIONS.uaBinding:"function"==typeof A.CALLBACK_FUNC.initCall_cb&&A.CALLBACK_FUNC.initCall_cb(l.extras.result)}}function t(e,a){console.log("---------action type---------"+e);var t={appid:A.appId,uri:"",type:"",action:"",flags:"background",extras:{}};switch(t.type=e,e){case A.ACTIONS.uaBinding:"object"===(void 0===a?"undefined":n(a))&&a.localIp&&l(a.localIp)&&"string"==typeof a.appId?(t.extras.localIp=a.localIp,t.extras.appId=a.appId,atelier.appman.sendAction(t,c)):console.log("----------localIp non valid-------------");break;case A.ACTIONS.uaCall:"object"===(void 0===a?"undefined":n(a))&&a.peerIp&&l(a.peerIp)&&"string"==typeof a.appId?(console.log("----------peerIp-----------"+a.peerIp),t.extras.peerIp=a.peerIp,t.extras.appId=a.appId,atelier.appman.sendAction(t,c)):console.log("----------peerIp non valid-------------");break;case A.ACTIONS.uaAnswer:case A.ACTIONS.uaHangup:atelier.appman.sendAction(t,c)}}function o(l,e){"function"==typeof e&&"object"===(void 0===l?"undefined":n(l))&&"string"==typeof l.localIp&&"string"==typeof l.appId&&(A.CALLBACK_FUNC.initCall_cb=e,A.myAppId=l.appId,t(A.ACTIONS.uaBinding,l))}function i(l,e){"function"==typeof e&&(A.CALLBACK_FUNC.makeCall_cb=e,t(A.ACTIONS.uaCall,l))}function C(l){"function"==typeof l&&(A.CALLBACK_FUNC.answerCall_cb=l,t(A.ACTIONS.uaAnswer))}function r(l){"function"==typeof l&&(A.CALLBACK_FUNC.hangUpCall_cb=l,t(A.ACTIONS.uaHangup))}function s(l){"function"==typeof l&&(A.LISTENER_FUNC.callAccept_listener=l)}function u(l){"function"==typeof l&&(A.LISTENER_FUNC.callBusy_listener=l)}function p(l){"function"==typeof l&&(A.LISTENER_FUNC.callCancel_listener=l)}function _(l){"function"==typeof l&&(A.LISTENER_FUNC.callEnd_listener=l)}function f(l){"function"==typeof l&&(A.LISTENER_FUNC.callCalling_listener=l)}function d(l){"function"==typeof l&&(A.LISTENER_FUNC.callReject_listener=l)}function I(l){"function"==typeof l&&(A.LISTENER_FUNC.callTimeout_listener=l)}function L(l){"function"==typeof l&&(A.LISTENER_FUNC.callIncoming_listener=l)}var A={ACTIONS:{uaBinding:"uaBinding",uaCall:"uaCall",uaHangup:"uaHangup",uaAnswer:"uaAnswer"},CALLBACK_ID:{uaCallbackCalling:"iecas_call_sip_ua_calling",uaCallbackCallTimeout:"iecas_call_sip_ua_call_timeout",uaCallbackCallCancel:"iecas_call_sip_ua_call_cancel",uaCallbackIncomingCall:"iecas_call_sip_ua_incoming_call",uaCallbackCallAccept:"iecas_call_sip_ua_call_accept",uaCallbackCallReject:"iecas_call_sip_ua_call_reject",uaCallbackCallBusy:"iecas_call_sip_ua_call_busy",uaCallbackCallEnd:"iecas_call_sip_ua_call_end"},CALLBACK_FUNC:{makeCall_cb:void 0,hangUpCall_cb:void 0,answerCall_cb:void 0,initCall_cb:void 0},LISTENER_FUNC:{callAccept_listener:void 0,callBusy_listener:void 0,callIncoming_listener:void 0,callCancel_listener:void 0,callEnd_listener:void 0,callReject_listener:void 0,callTimeout_listener:void 0,callCalling_listener:void 0},STATUS_CODE:{SUCCESS:100,ACTION_TYPE_ERROR:101,PARAMS_ERROR:102,RESULT_ERROR:103},appId:"iecas.call.server",myAppId:""};return atelier.appman.onBackground.addListener(a),atelier.appman.onAction.addListener(e),{init:o,makeCall:i,answerCall:C,hangupCall:r,addCallIncomingListener:L,addCallTimeoutListener:I,addCallRejectListener:d,addCallCallingListener:f,addCallCancelListener:p,addCallEndListener:_,addCallBusyListener:u,addCallAcceptListener:s}}()}(window)}])});
