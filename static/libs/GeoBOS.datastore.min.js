!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";(function(r){var i,o,u,u,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(r){"function"==typeof bootstrap?bootstrap("nedb",r):"object"==a(e)?t.exports=r():(i=r,void 0!==(o="function"==typeof i?i.call(e,n,e,t):i)&&(t.exports=o))}(function(){var t;return function(t,e,n){function r(n,o){if(!e[n]){if(!t[n]){var a="function"==typeof u&&u;if(!o&&a)return u(n,!0);if(i)return u(n,!0);throw new Error("Cannot find module '"+n+"'")}var c=e[n]={exports:{}};t[n][0].call(c.exports,function(e){var i=t[n][1][e];return r(i||e)},c,c.exports)}return e[n].exports}for(var i="function"==typeof u&&u,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){function r(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}var i=t("__browserify_process");i.EventEmitter||(i.EventEmitter=function(){});var o=n.EventEmitter=i.EventEmitter,u="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};o.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},o.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||u(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(u(e)){for(var n=Array.prototype.slice.call(arguments,1),r=e.slice(),i=0,o=r.length;i<o;i++)r[i].apply(this,n);return!0}return!1},o.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(u(this._events[t])){if(!this._events[t].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:10,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},o.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(u(n)){var i=r(n,e);if(i<0)return this;n.splice(i,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},o.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},o.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),u(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},o.listenerCount=function(t,e){return t._events&&t._events[e]?"function"==typeof t._events[e]?1:t._events[e].length:0}},{__browserify_process:4}],2:[function(t,e,n){function r(t,e){for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}function i(t,e){for(var n=0,r=t.length;r>=0;r--){var i=t[r];"."==i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var o=t("__browserify_process"),u=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){for(var t="",e=!1,n=arguments.length;n>=-1&&!e;n--){var u=n>=0?arguments[n]:o.cwd();"string"==typeof u&&u&&(t=u+"/"+t,e="/"===u.charAt(0))}return t=i(r(t.split("/"),function(t){return!!t}),!e).join("/"),(e?"/":"")+t||"."},n.normalize=function(t){var e="/"===t.charAt(0),n="/"===t.slice(-1);return t=i(r(t.split("/"),function(t){return!!t}),!e).join("/"),t||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){return t&&"string"==typeof t}).join("/"))},n.dirname=function(t){var e=u.exec(t)[1]||"";return e?1===e.length?e:e.substring(0,e.length-1):"."},n.basename=function(t,e){var n=u.exec(t)[2]||"";return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return u.exec(t)[3]||""},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),u=Math.min(i.length,o.length),a=u,c=0;c<u;c++)if(i[c]!==o[c]){a=c;break}for(var s=[],c=a;c<i.length;c++)s.push("..");return s=s.concat(o.slice(a)),s.join("/")},n.sep="/"},{__browserify_process:4}],3:[function(t,e,n){function r(t){return Array.isArray(t)||"object"===(void 0===t?"undefined":a(t))&&"[object Array]"===Object.prototype.toString.call(t)}function i(t){"object"===(void 0===t?"undefined":a(t))&&Object.prototype.toString.call(t)}function o(t){return"object"===(void 0===t?"undefined":a(t))&&"[object Date]"===Object.prototype.toString.call(t)}t("events");n.isArray=r,n.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},n.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(t,e,s,l){function f(t,s){if(t&&"function"==typeof t.inspect&&t!==n&&(!t.constructor||t.constructor.prototype!==t))return t.inspect(s);switch(void 0===t?"undefined":a(t)){case"undefined":return p("undefined","undefined");case"string":var l="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return p(l,"string");case"number":return p(""+t,"number");case"boolean":return p(""+t,"boolean")}if(null===t)return p("null","null");var d=u(t),y=e?c(t):d;if("function"==typeof t&&0===y.length){if(i(t))return p(""+t,"regexp");var v=t.name?": "+t.name:"";return p("[Function"+v+"]","special")}if(o(t)&&0===y.length)return p(t.toUTCString(),"date");var g,m,b;if(r(t)?(m="Array",b=["[","]"]):(m="Object",b=["{","}"]),"function"==typeof t){var w=t.name?": "+t.name:"";g=i(t)?" "+t:" [Function"+w+"]"}else g="";if(o(t)&&(g=" "+t.toUTCString()),0===y.length)return b[0]+g+b[1];if(s<0)return i(t)?p(""+t,"regexp"):p("[Object]","special");h.push(t);var x=y.map(function(e){var n,i;if(t.__lookupGetter__&&(t.__lookupGetter__(e)?i=t.__lookupSetter__(e)?p("[Getter/Setter]","special"):p("[Getter]","special"):t.__lookupSetter__(e)&&(i=p("[Setter]","special"))),d.indexOf(e)<0&&(n="["+e+"]"),i||(h.indexOf(t[e])<0?(i=null===s?f(t[e]):f(t[e],s-1),i.indexOf("\n")>-1&&(i=r(t)?i.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+i.split("\n").map(function(t){return"   "+t}).join("\n"))):i=p("[Circular]","special")),void 0===n){if("Array"===m&&e.match(/^\d+$/))return i;n=JSON.stringify(""+e),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=p(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=p(n,"string"))}return n+": "+i});h.pop();var k=0;return x=x.reduce(function(t,e){return k++,e.indexOf("\n")>=0&&k++,t+e.length+1},0)>50?b[0]+(""===g?"":g+"\n ")+" "+x.join(",\n  ")+" "+b[1]:b[0]+g+" "+x.join(", ")+" "+b[1]}var h=[],p=function(t,e){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r={special:"cyan",number:"blue",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"}[e];return r?"["+n[r][0]+"m"+t+"["+n[r][1]+"m":t};return l||(p=function(t,e){return t}),f(t,void 0===s?2:s)};n.log=function(t){},n.pump=null;var u=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},c=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.hasOwnProperty.call(t,n)&&e.push(n);return e},s=Object.create||function(t,e){var n;if(null===t)n={__proto__:null};else{if("object"!==(void 0===t?"undefined":a(t)))throw new TypeError("typeof prototype["+(void 0===t?"undefined":a(t))+"] != 'object'");var r=function(){};r.prototype=t,n=new r,n.__proto__=t}return void 0!==e&&Object.defineProperties&&Object.defineProperties(n,e),n};n.inherits=function(t,e){t.super_=e,t.prototype=s(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})};var l=/%[sdj%]/g;n.format=function(t){if("string"!=typeof t){for(var e=[],r=0;r<arguments.length;r++)e.push(n.inspect(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,o=i.length,u=String(t).replace(l,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":return JSON.stringify(i[r++]);default:return t}}),c=i[r];r<o;c=i[++r])null===c||"object"!==(void 0===c?"undefined":a(c))?u+=" "+c:u+=" "+n.inspect(c);return u}},{events:1}],4:[function(t,e,n){var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){n.shift()()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],5:[function(t,e,n){function r(t,e,n){this.db=t,this.query=e||{},n&&(this.execFn=n)}var i=t("./model"),o=t("underscore");r.prototype.limit=function(t){return this._limit=t,this},r.prototype.skip=function(t){return this._skip=t,this},r.prototype.sort=function(t){return this._sort=t,this},r.prototype.projection=function(t){return this._projection=t,this},r.prototype.project=function(t){var e,n,r,u=[],a=this;return void 0===this._projection||0===Object.keys(this._projection).length?t:(e=0!==this._projection._id,this._projection=o.omit(this._projection,"_id"),r=Object.keys(this._projection),r.forEach(function(t){if(void 0!==n&&a._projection[t]!==n)throw new Error("Can't both keep and omit fields except for _id");n=a._projection[t]}),t.forEach(function(t){var o;1===n?(o={$set:{}},r.forEach(function(e){o.$set[e]=i.getDotValue(t,e),void 0===o.$set[e]&&delete o.$set[e]}),o=i.modify({},o)):(o={$unset:{}},r.forEach(function(t){o.$unset[t]=!0}),o=i.modify(t,o)),e?o._id=t._id:delete o._id,u.push(o)}),u)},r.prototype._exec=function(t){function e(e,n){return s.execFn?s.execFn(e,n,t):t(e,n)}var n,r,o,u=[],a=0,c=0,s=this,l=null;this.db.getCandidates(this.query,function(t,f){if(t)return e(t);try{for(n=0;n<f.length;n+=1)if(i.match(f[n],s.query))if(s._sort)u.push(f[n]);else if(s._skip&&s._skip>c)c+=1;else if(u.push(f[n]),a+=1,s._limit&&s._limit<=a)break}catch(t){return e(t)}if(s._sort){r=Object.keys(s._sort);var h=[];for(n=0;n<r.length;n++)o=r[n],h.push({key:o,direction:s._sort[o]});u.sort(function(t,e){var n,r,o;for(o=0;o<h.length;o++)if(n=h[o],0!==(r=n.direction*i.compareThings(i.getDotValue(t,n.key),i.getDotValue(e,n.key),s.db.compareStrings)))return r;return 0});var p=s._limit||u.length,d=s._skip||0;u=u.slice(d,d+p)}try{u=s.project(u)}catch(t){l=t,u=void 0}return e(l,u)})},r.prototype.exec=function(){this.db.executor.push({this:this,fn:this._exec,arguments:arguments})},e.exports=r},{"./model":10,underscore:19}],6:[function(t,e,n){function r(t){for(var e,e,n=new Array(t),r=0;r<t;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n}function i(t){var e,n,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=t.length%3,u="";for(r=0,n=t.length-o;r<n;r+=3)e=(t[r]<<16)+(t[r+1]<<8)+t[r+2],u+=function(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}(e);switch(o){case 1:e=t[t.length-1],u+=i[e>>2],u+=i[e<<4&63],u+="==";break;case 2:e=(t[t.length-2]<<8)+t[t.length-1],u+=i[e>>10],u+=i[e>>4&63],u+=i[e<<2&63],u+="="}return u}function o(t){return i(r(Math.ceil(Math.max(8,2*t)))).replace(/[+\/]/g,"").slice(0,t)}e.exports.uid=o},{}],7:[function(t,e,n){function r(t){var e;"string"==typeof t?(e=t,this.inMemoryOnly=!1):(t=t||{},e=t.filename,this.inMemoryOnly=t.inMemoryOnly||!1,this.autoload=t.autoload||!1,this.timestampData=t.timestampData||!1),e&&"string"==typeof e&&0!==e.length?this.filename=e:(this.filename=null,this.inMemoryOnly=!0),this.compareStrings=t.compareStrings,this.persistence=new f({db:this,nodeWebkitAppName:t.nodeWebkitAppName,afterSerialization:t.afterSerialization,beforeDeserialization:t.beforeDeserialization,corruptAlertThreshold:t.corruptAlertThreshold}),this.executor=new a,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new c({fieldName:"_id",unique:!0}),this.ttlIndexes={},this.autoload&&this.loadDatabase(t.onload||function(t){if(t)throw t})}var i=t("./customUtils"),o=t("./model"),u=t("async"),a=t("./executor"),c=t("./indexes"),s=t("util"),l=t("underscore"),f=t("./persistence"),h=t("./cursor"),p=t("./storage");s.inherits(r,t("events").EventEmitter),r.prototype.loadDatabase=function(){this.executor.push({this:this.persistence,fn:this.persistence.loadDatabase,arguments:arguments},!0)},r.prototype.getAllData=function(){return this.indexes._id.getAll()},r.prototype.resetIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].reset(t)})},r.prototype.ensureIndex=function(t,e){var n,r=e||function(){};if(t=t||{},!t.fieldName)return n=new Error("Cannot create an index without a fieldName"),n.missingFieldName=!0,r(n);if(this.indexes[t.fieldName])return r(null);this.indexes[t.fieldName]=new c(t),void 0!==t.expireAfterSeconds&&(this.ttlIndexes[t.fieldName]=t.expireAfterSeconds);try{this.indexes[t.fieldName].insert(this.getAllData())}catch(e){return delete this.indexes[t.fieldName],r(e)}this.persistence.persistNewState([{$$indexCreated:t}],function(t){return r(t?t:null)})},r.prototype.removeIndex=function(t,e){var n=e||function(){};delete this.indexes[t],this.persistence.persistNewState([{$$indexRemoved:t}],function(t){return n(t?t:null)})},r.prototype.addToIndexes=function(t){var e,n,r,i=Object.keys(this.indexes);for(e=0;e<i.length;e+=1)try{this.indexes[i[e]].insert(t)}catch(t){n=e,r=t;break}if(r){for(e=0;e<n;e+=1)this.indexes[i[e]].remove(t);throw r}},r.prototype.removeFromIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].remove(t)})},r.prototype.updateIndexes=function(t,e){var n,r,i,o=Object.keys(this.indexes);for(n=0;n<o.length;n+=1)try{this.indexes[o[n]].update(t,e)}catch(t){r=n,i=t;break}if(i){for(n=0;n<r;n+=1)this.indexes[o[n]].revertUpdate(t,e);throw i}},r.prototype.getCandidates=function(t,e,n){var r,i=Object.keys(this.indexes),o=this;"function"==typeof e&&(n=e,e=!1),u.waterfall([function(e){return r=[],Object.keys(t).forEach(function(e){("string"==typeof t[e]||"number"==typeof t[e]||"boolean"==typeof t[e]||s.isDate(t[e])||null===t[e])&&r.push(e)}),r=l.intersection(r,i),r.length>0?e(null,o.indexes[r[0]].getMatching(t[r[0]])):(r=[],Object.keys(t).forEach(function(e){t[e]&&t[e].hasOwnProperty("$in")&&r.push(e)}),r=l.intersection(r,i),r.length>0?e(null,o.indexes[r[0]].getMatching(t[r[0]].$in)):(r=[],Object.keys(t).forEach(function(e){t[e]&&(t[e].hasOwnProperty("$lt")||t[e].hasOwnProperty("$lte")||t[e].hasOwnProperty("$gt")||t[e].hasOwnProperty("$gte"))&&r.push(e)}),r=l.intersection(r,i),r.length>0?e(null,o.indexes[r[0]].getBetweenBounds(t[r[0]])):e(null,o.getAllData())))},function(t){if(e)return n(null,t);var r=[],i=[],a=Object.keys(o.ttlIndexes);t.forEach(function(t){var e=!0;a.forEach(function(n){void 0!==t[n]&&s.isDate(t[n])&&Date.now()>t[n].getTime()+1e3*o.ttlIndexes[n]&&(e=!1)}),e?i.push(t):r.push(t._id)}),u.eachSeries(r,function(t,e){o._remove({_id:t},{},function(t){return t?n(t):e()})},function(t){return n(null,i)})}])},r.prototype._insert=function(t,e){var n,r=e||function(){};try{n=this.prepareDocumentForInsertion(t),this._insertInCache(n)}catch(t){return r(t)}this.persistence.persistNewState(s.isArray(n)?n:[n],function(t){return t?r(t):r(null,o.deepCopy(n))})},r.prototype.createNewId=function(){var t=i.uid(16);return this.indexes._id.getMatching(t).length>0&&(t=this.createNewId()),t},r.prototype.prepareDocumentForInsertion=function(t){var e,n=this;if(s.isArray(t))e=[],t.forEach(function(t){e.push(n.prepareDocumentForInsertion(t))});else{e=o.deepCopy(t),void 0===e._id&&(e._id=this.createNewId());var r=new Date;this.timestampData&&void 0===e.createdAt&&(e.createdAt=r),this.timestampData&&void 0===e.updatedAt&&(e.updatedAt=r),o.checkObject(e)}return e},r.prototype._insertInCache=function(t){s.isArray(t)?this._insertMultipleDocsInCache(t):this.addToIndexes(t)},r.prototype._insertMultipleDocsInCache=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.addToIndexes(t[e])}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.removeFromIndexes(t[e]);throw r}},r.prototype.insert=function(){this.executor.push({this:this,fn:this._insert,arguments:arguments})},r.prototype.count=function(t,e){var n=new h(this,t,function(t,e,n){return t?n(t):n(null,e.length)});if("function"!=typeof e)return n;n.exec(e)},r.prototype.find=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new h(this,t,function(t,e,n){var r,i=[];if(t)return n(t);for(r=0;r<e.length;r+=1)i.push(o.deepCopy(e[r]));return n(null,i)});if(r.projection(e),"function"!=typeof n)return r;r.exec(n)},r.prototype.findOne=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new h(this,t,function(t,e,n){return t?n(t):1===e.length?n(null,o.deepCopy(e[0])):n(null,null)});if(r.projection(e).limit(1),"function"!=typeof n)return r;r.exec(n)},r.prototype._update=function(t,e,n,r){var i,a,c,s,f=this,p=0;"function"==typeof n&&(r=n,n={}),i=r||function(){},a=void 0!==n.multi&&n.multi,c=void 0!==n.upsert&&n.upsert,u.waterfall([function(n){if(!c)return n();new h(f,t).limit(1)._exec(function(r,u){if(r)return i(r);if(1===u.length)return n();var a;try{o.checkObject(e),a=e}catch(n){try{a=o.modify(o.deepCopy(t,!0),e)}catch(r){return i(r)}}return f._insert(a,function(t,e){return t?i(t):i(null,1,e,!0)})})},function(){var r,u,c=[];f.getCandidates(t,function(h,d){if(h)return i(h);try{for(s=0;s<d.length;s+=1)o.match(d[s],t)&&(a||0===p)&&(p+=1,f.timestampData&&(u=d[s].createdAt),r=o.modify(d[s],e),f.timestampData&&(r.createdAt=u,r.updatedAt=new Date),c.push({oldDoc:d[s],newDoc:r}))}catch(h){return i(h)}try{f.updateIndexes(c)}catch(h){return i(h)}var y=l.pluck(c,"newDoc");f.persistence.persistNewState(y,function(t){if(t)return i(t);if(n.returnUpdatedDocs){var e=[];return y.forEach(function(t){e.push(o.deepCopy(t))}),a||(e=e[0]),i(null,p,e)}return i(null,p)})})}])},r.prototype.update=function(){this.executor.push({this:this,fn:this._update,arguments:arguments})},r.prototype._remove=function(t,e,n){var r,i,u=this,a=0,c=[];"function"==typeof e&&(n=e,e={}),r=n||function(){},i=void 0!==e.multi&&e.multi,this.getCandidates(t,!0,function(e,n){if(e)return r(e);try{n.forEach(function(e){o.match(e,t)&&(i||0===a)&&(a+=1,c.push({$$deleted:!0,_id:e._id}),u.removeFromIndexes(e))})}catch(e){return r(e)}u.persistence.persistNewState(c,function(t){return t?r(t):r(null,a)})})},r.prototype.remove=function(){this.executor.push({this:this,fn:this._remove,arguments:arguments})},r.prototype._drop=function(t){var e=t||function(){},n=this;p.exists(this.filename,function(t){t?p.unlink(n.filename,function(t){t?e(t):e()}):e()})},r.prototype.drop=function(){this.executor.push({this:this,fn:this._drop,arguments:arguments})},e.exports=r},{"./cursor":5,"./customUtils":6,"./executor":8,"./indexes":9,"./model":10,"./persistence":11,"./storage":12,async:13,events:1,underscore:19,util:3}],8:[function(t,e,n){function i(){this.buffer=[],this.ready=!1,this.queue=u.queue(function(t,e){for(var n=[],i=0;i<t.arguments.length;i+=1)n.push(t.arguments[i]);var u=t.arguments[t.arguments.length-1];"function"==typeof u?n[n.length-1]=function(){"function"==typeof r?r(e):o.nextTick(e),u.apply(null,arguments)}:u||0===t.arguments.length?n.push(function(){e()}):n[n.length-1]=function(){e()},t.fn.apply(t.this,n)},1)}var o=t("__browserify_process"),u=t("async");i.prototype.push=function(t,e){this.ready||e?this.queue.push(t):this.buffer.push(t)},i.prototype.processBuffer=function(){var t;for(this.ready=!0,t=0;t<this.buffer.length;t+=1)this.queue.push(this.buffer[t]);this.buffer=[]},e.exports=i},{__browserify_process:4,async:13}],9:[function(t,e,n){function r(t,e){return t===e}function i(t){return null===t?"$null":"string"==typeof t?"$string"+t:"boolean"==typeof t?"$boolean"+t:"number"==typeof t?"$number"+t:s.isArray(t)?"$date"+t.getTime():t}function o(t){this.fieldName=t.fieldName,this.unique=t.unique||!1,this.sparse=t.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:a.compareThings,checkValueEquality:r},this.reset()}var u=t("binary-search-tree").AVLTree,a=t("./model"),c=t("underscore"),s=t("util");o.prototype.reset=function(t){this.tree=new u(this.treeOptions),t&&this.insert(t)},o.prototype.insert=function(t){var e,n,r,o,u;if(s.isArray(t))return void this.insertMultipleDocs(t);if(void 0!==(e=a.getDotValue(t,this.fieldName))||!this.sparse)if(s.isArray(e)){for(n=c.uniq(e,i),r=0;r<n.length;r+=1)try{this.tree.insert(n[r],t)}catch(t){u=t,o=r;break}if(u){for(r=0;r<o;r+=1)this.tree.delete(n[r],t);throw u}}else this.tree.insert(e,t)},o.prototype.insertMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.insert(t[e])}catch(t){n=t,r=e;break}if(n){for(e=0;e<r;e+=1)this.remove(t[e]);throw n}},o.prototype.remove=function(t){var e,n=this;if(s.isArray(t))return void t.forEach(function(t){n.remove(t)});void 0===(e=a.getDotValue(t,this.fieldName))&&this.sparse||(s.isArray(e)?c.uniq(e,i).forEach(function(e){n.tree.delete(e,t)}):this.tree.delete(e,t))},o.prototype.update=function(t,e){if(s.isArray(t))return void this.updateMultipleDocs(t);this.remove(t);try{this.insert(e)}catch(e){throw this.insert(t),e}},o.prototype.updateMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)this.remove(t[e].oldDoc);for(e=0;e<t.length;e+=1)try{this.insert(t[e].newDoc)}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.remove(t[e].newDoc);for(e=0;e<t.length;e+=1)this.insert(t[e].oldDoc);throw r}},o.prototype.revertUpdate=function(t,e){var n=[];s.isArray(t)?(t.forEach(function(t){n.push({oldDoc:t.newDoc,newDoc:t.oldDoc})}),this.update(n)):this.update(e,t)},o.prototype.getMatching=function(t){var e=this;if(s.isArray(t)){var n={},r=[];return t.forEach(function(t){e.getMatching(t).forEach(function(t){n[t._id]=t})}),Object.keys(n).forEach(function(t){r.push(n[t])}),r}return e.tree.search(t)},o.prototype.getBetweenBounds=function(t){return this.tree.betweenBounds(t)},o.prototype.getAll=function(){var t=[];return this.tree.executeOnEveryNode(function(e){var n;for(n=0;n<e.data.length;n+=1)t.push(e.data[n])}),t},e.exports=o},{"./model":10,"binary-search-tree":14,underscore:19,util:3}],10:[function(t,e,n){function r(t,e){if("number"==typeof t&&(t=t.toString()),!("$"!==t[0]||"$$date"===t&&"number"==typeof e||"$$deleted"===t&&!0===e||"$$indexCreated"===t||"$$indexRemoved"===t))throw new Error("Field names cannot begin with the $ character");if(-1!==t.indexOf("."))throw new Error("Field names cannot contain a .")}function i(t){w.isArray(t)&&t.forEach(function(t){i(t)}),"object"===(void 0===t?"undefined":a(t))&&null!==t&&Object.keys(t).forEach(function(e){r(e,t[e]),i(t[e])})}function o(t){return JSON.stringify(t,function(t,e){if(r(t,e),void 0!==e)return null===e?null:"function"==typeof this[t].getTime?{$$date:this[t].getTime()}:e})}function u(t){return JSON.parse(t,function(t,e){return"$$date"===t?new Date(e):"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?e:e&&e.$$date?e.$$date:e})}function c(t,e){var n;return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||w.isDate(t)?t:w.isArray(t)?(n=[],t.forEach(function(t){n.push(c(t,e))}),n):"object"===(void 0===t?"undefined":a(t))?(n={},Object.keys(t).forEach(function(r){(!e||"$"!==r[0]&&-1===r.indexOf("."))&&(n[r]=c(t[r],e))}),n):void 0}function s(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||w.isDate(t)||w.isArray(t)}function l(t,e){return t<e?-1:t>e?1:0}function f(t,e){var n,r;for(n=0;n<Math.min(t.length,e.length);n+=1)if(0!==(r=h(t[n],e[n])))return r;return l(t.length,e.length)}function h(t,e,n){var r,i,o,u,a=n||l;if(void 0===t)return void 0===e?0:-1;if(void 0===e)return void 0===t?0:1;if(null===t)return null===e?0:-1;if(null===e)return null===t?0:1;if("number"==typeof t)return"number"==typeof e?l(t,e):-1;if("number"==typeof e)return"number"==typeof t?l(t,e):1;if("string"==typeof t)return"string"==typeof e?a(t,e):-1;if("string"==typeof e)return"string"==typeof t?a(t,e):1;if("boolean"==typeof t)return"boolean"==typeof e?l(t,e):-1;if("boolean"==typeof e)return"boolean"==typeof t?l(t,e):1;if(w.isDate(t))return w.isDate(e)?l(t.getTime(),e.getTime()):-1;if(w.isDate(e))return w.isDate(t)?l(t.getTime(),e.getTime()):1;if(w.isArray(t))return w.isArray(e)?f(t,e):-1;if(w.isArray(e))return w.isArray(t)?f(t,e):1;for(r=Object.keys(t).sort(),i=Object.keys(e).sort(),u=0;u<Math.min(r.length,i.length);u+=1)if(0!==(o=h(t[r[u]],e[i[u]])))return o;return l(r.length,i.length)}function p(t){return function(e,n,r){var i="string"==typeof n?n.split("."):n;if(1===i.length)_[t](e,n,r);else{if(void 0===e[i[0]]){if("$unset"===t)return;e[i[0]]={}}k[t](e[i[0]],i.slice(1),r)}}}function d(t,e){var n,r,o=Object.keys(e),u=x.map(o,function(t){return t[0]}),s=x.filter(u,function(t){return"$"===t});if(-1!==o.indexOf("_id")&&e._id!==t._id)throw new Error("You cannot change a document's _id");if(0!==s.length&&s.length!==u.length)throw new Error("You cannot mix modifiers and normal fields");if(0===s.length?(n=c(e),n._id=t._id):(r=x.uniq(o),n=c(t),r.forEach(function(t){var r;if(!k[t])throw new Error("Unknown modifier "+t);if("object"!==a(e[t]))throw new Error("Modifier "+t+"'s argument must be an object");r=Object.keys(e[t]),r.forEach(function(r){k[t](n,r,e[t][r])})})),i(n),t._id!==n._id)throw new Error("You can't change a document's _id");return n}function y(t,e){var n,r,i="string"==typeof e?e.split("."):e;if(t){if(0===i.length)return t;if(1===i.length)return t[i[0]];if(w.isArray(t[i[0]])){if("number"==typeof(n=parseInt(i[1],10))&&!isNaN(n))return y(t[i[0]][n],i.slice(2));for(r=new Array,n=0;n<t[i[0]].length;n+=1)r.push(y(t[i[0]][n],i.slice(1)));return r}return y(t[i[0]],i.slice(1))}}function v(t,e){var n,r,i;if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return t===e;if(w.isDate(t)||w.isDate(e))return w.isDate(t)&&w.isDate(e)&&t.getTime()===e.getTime();if((!w.isArray(t)||!w.isArray(e))&&(w.isArray(t)||w.isArray(e))||void 0===t||void 0===e)return!1;try{n=Object.keys(t),r=Object.keys(e)}catch(t){return!1}if(n.length!==r.length)return!1;for(i=0;i<n.length;i+=1){if(-1===r.indexOf(n[i]))return!1;if(!v(t[n[i]],e[n[i]]))return!1}return!0}function g(t,e){return!("string"!=typeof t&&"number"!=typeof t&&!w.isDate(t)&&"string"!=typeof e&&"number"!=typeof e&&!w.isDate(e))&&(void 0===t?"undefined":a(t))===(void 0===e?"undefined":a(e))}function m(t,e){var n,r,i,o;if(s(t)||s(e))return b({needAKey:t},"needAKey",e);for(n=Object.keys(e),o=0;o<n.length;o+=1)if(r=n[o],i=e[r],"$"===r[0]){if(!O[r])throw new Error("Unknown logical operator "+r);if(!O[r](t,i))return!1}else if(!b(t,r,i))return!1;return!0}function b(t,e,n,r){var i,o,u,c,s=y(t,e);if(w.isArray(s)&&!r){if(w.isArray(n))return b(t,e,n,!0);if(null!==n&&"object"===(void 0===n?"undefined":a(n))&&!w.isRegExp(n))for(o=Object.keys(n),i=0;i<o.length;i+=1)if(E[o[i]])return b(t,e,n,!0);for(i=0;i<s.length;i+=1)if(b({k:s[i]},"k",n))return!0;return!1}if(null!==n&&"object"===(void 0===n?"undefined":a(n))&&!w.isRegExp(n)&&!w.isArray(n)){if(o=Object.keys(n),u=x.map(o,function(t){return t[0]}),c=x.filter(u,function(t){return"$"===t}),0!==c.length&&c.length!==u.length)throw new Error("You cannot mix operators and normal fields");if(c.length>0){for(i=0;i<o.length;i+=1){if(!A[o[i]])throw new Error("Unknown comparison function "+o[i]);if(!A[o[i]](s,n[o[i]]))return!1}return!0}}return w.isRegExp(n)?A.$regex(s,n):!!v(s,n)}var w=t("util"),x=t("underscore"),k={},_={},A={},O={},E={};_.$set=function(t,e,n){t[e]=n},_.$unset=function(t,e,n){delete t[e]},_.$push=function(t,e,n){if(t.hasOwnProperty(e)||(t[e]=[]),!w.isArray(t[e]))throw new Error("Can't $push an element on non-array values");if(null!==n&&"object"===(void 0===n?"undefined":a(n))&&n.$slice&&void 0===n.$each&&(n.$each=[]),null!==n&&"object"===(void 0===n?"undefined":a(n))&&n.$each){if(Object.keys(n).length>=3||2===Object.keys(n).length&&void 0===n.$slice)throw new Error("Can only use $slice in cunjunction with $each when $push to array");if(!w.isArray(n.$each))throw new Error("$each requires an array value");if(n.$each.forEach(function(n){t[e].push(n)}),void 0===n.$slice||"number"!=typeof n.$slice)return;if(0===n.$slice)t[e]=[];else{var r,i,o=t[e].length;n.$slice<0?(r=Math.max(0,o+n.$slice),i=o):n.$slice>0&&(r=0,i=Math.min(o,n.$slice)),t[e]=t[e].slice(r,i)}}else t[e].push(n)},_.$addToSet=function(t,e,n){var r=!0;if(t.hasOwnProperty(e)||(t[e]=[]),!w.isArray(t[e]))throw new Error("Can't $addToSet an element on non-array values");if(null!==n&&"object"===(void 0===n?"undefined":a(n))&&n.$each){if(Object.keys(n).length>1)throw new Error("Can't use another field in conjunction with $each");if(!w.isArray(n.$each))throw new Error("$each requires an array value");n.$each.forEach(function(n){_.$addToSet(t,e,n)})}else t[e].forEach(function(t){0===h(t,n)&&(r=!1)}),r&&t[e].push(n)},_.$pop=function(t,e,n){if(!w.isArray(t[e]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof n)throw new Error(n+" isn't an integer, can't use it with $pop");0!==n&&(t[e]=n>0?t[e].slice(0,t[e].length-1):t[e].slice(1))},_.$pull=function(t,e,n){var r,i;if(!w.isArray(t[e]))throw new Error("Can't $pull an element from non-array values");for(r=t[e],i=r.length-1;i>=0;i-=1)m(r[i],n)&&r.splice(i,1)},_.$inc=function(t,e,n){if("number"!=typeof n)throw new Error(n+" must be a number");if("number"!=typeof t[e]){if(x.has(t,e))throw new Error("Don't use the $inc modifier on non-number fields");t[e]=n}else t[e]+=n},_.$max=function(t,e,n){void 0===t[e]?t[e]=n:n>t[e]&&(t[e]=n)},_.$min=function(t,e,n){void 0===t[e]?t[e]=n:n<t[e]&&(t[e]=n)},Object.keys(_).forEach(function(t){k[t]=p(t)}),A.$lt=function(t,e){return g(t,e)&&t<e},A.$lte=function(t,e){return g(t,e)&&t<=e},A.$gt=function(t,e){return g(t,e)&&t>e},A.$gte=function(t,e){return g(t,e)&&t>=e},A.$ne=function(t,e){return void 0===t||!v(t,e)},A.$in=function(t,e){var n;if(!w.isArray(e))throw new Error("$in operator called with a non-array");for(n=0;n<e.length;n+=1)if(v(t,e[n]))return!0;return!1},A.$nin=function(t,e){if(!w.isArray(e))throw new Error("$nin operator called with a non-array");return!A.$in(t,e)},A.$regex=function(t,e){if(!w.isRegExp(e))throw new Error("$regex operator called with non regular expression");return"string"==typeof t&&e.test(t)},A.$exists=function(t,e){return e=!(!e&&""!==e),void 0===t?!e:e},A.$size=function(t,e){if(!w.isArray(t))return!1;if(e%1!=0)throw new Error("$size operator called without an integer");return t.length==e},A.$elemMatch=function(t,e){if(!w.isArray(t))return!1;for(var n=t.length,r=!1;n--;)if(m(t[n],e)){r=!0;break}return r},E.$size=!0,E.$elemMatch=!0,O.$or=function(t,e){var n;if(!w.isArray(e))throw new Error("$or operator used without an array");for(n=0;n<e.length;n+=1)if(m(t,e[n]))return!0;return!1},O.$and=function(t,e){var n;if(!w.isArray(e))throw new Error("$and operator used without an array");for(n=0;n<e.length;n+=1)if(!m(t,e[n]))return!1;return!0},O.$not=function(t,e){return!m(t,e)},O.$where=function(t,e){var n;if(!x.isFunction(e))throw new Error("$where operator used without a function");if(n=e.call(t),!x.isBoolean(n))throw new Error("$where function must return boolean");return n},e.exports.serialize=o,e.exports.deserialize=u,e.exports.deepCopy=c,e.exports.checkObject=i,e.exports.isPrimitiveType=s,e.exports.modify=d,e.exports.getDotValue=y,e.exports.match=m,e.exports.areThingsEqual=v,e.exports.compareThings=h},{underscore:19,util:3}],11:[function(t,e,n){function r(t){var e,n,i;if(this.db=t.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==t.corruptAlertThreshold?t.corruptAlertThreshold:.1,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(t.afterSerialization&&!t.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NeDB to prevent dataloss");if(!t.afterSerialization&&t.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NeDB to prevent dataloss");for(this.afterSerialization=t.afterSerialization||function(t){return t},this.beforeDeserialization=t.beforeDeserialization||function(t){return t},e=1;e<30;e+=1)for(n=0;n<10;n+=1)if(i=s.uid(e),this.beforeDeserialization(this.afterSerialization(i))!==i)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NeDB to prevent dataloss");this.filename&&t.nodeWebkitAppName&&(console.log("=================================================================="),console.log("WARNING: The nodeWebkitAppName option is deprecated"),console.log("To get the path to the directory where Node Webkit stores the data"),console.log("for your app, use the internal nw.gui module like this"),console.log("require('nw.gui').App.dataPath"),console.log("See https://github.com/rogerwang/node-webkit/issues/500"),console.log("=================================================================="),this.filename=r.getNWAppFilename(t.nodeWebkitAppName,this.filename))}var i=t("__browserify_process"),o=t("./storage"),u=t("path"),a=t("./model"),c=t("async"),s=t("./customUtils"),l=t("./indexes");r.ensureDirectoryExists=function(t,e){var n=e||function(){};o.mkdirp(t,function(t){return n(t)})},r.getNWAppFilename=function(t,e){var n;switch(i.platform){case"win32":case"win64":if(!(n=i.env.LOCALAPPDATA||i.env.APPDATA))throw new Error("Couldn't find the base application data folder");n=u.join(n,t);break;case"darwin":if(!(n=i.env.HOME))throw new Error("Couldn't find the base application data directory");n=u.join(n,"Library","Application Support",t);break;case"linux":if(!(n=i.env.HOME))throw new Error("Couldn't find the base application data directory");n=u.join(n,".config",t);break;default:throw new Error("Can't use the Node Webkit relative path for platform "+i.platform)}return u.join(n,"nedb-data",e)},r.prototype.persistCachedDatabase=function(t){var e=t||function(){},n="",r=this;if(this.inMemoryOnly)return e(null);this.db.getAllData().forEach(function(t){n+=r.afterSerialization(a.serialize(t))+"\n"}),Object.keys(this.db.indexes).forEach(function(t){"_id"!=t&&(n+=r.afterSerialization(a.serialize({$$indexCreated:{fieldName:t,unique:r.db.indexes[t].unique,sparse:r.db.indexes[t].sparse}}))+"\n")}),o.crashSafeWriteFile(this.filename,n,function(t){return t?e(t):(r.db.emit("compaction.done"),e(null))})},r.prototype.compactDatafile=function(){this.db.executor.push({this:this,fn:this.persistCachedDatabase,arguments:[]})},r.prototype.setAutocompactionInterval=function(t){var e=this,n=Math.max(t||0,5e3);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval(function(){e.compactDatafile()},n)},r.prototype.stopAutocompaction=function(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)},r.prototype.persistNewState=function(t,e){var n=this,r="",i=e||function(){};return n.inMemoryOnly?i(null):(t.forEach(function(t){r+=n.afterSerialization(a.serialize(t))+"\n"}),0===r.length?i(null):void o.appendFile(n.filename,r,"utf8",function(t){return i(t)}))},r.prototype.treatRawData=function(t){var e,n=t.split("\n"),r={},i=[],o={},u=-1;for(e=0;e<n.length;e+=1){var c;try{c=a.deserialize(this.beforeDeserialization(n[e])),c._id?!0===c.$$deleted?delete r[c._id]:r[c._id]=c:c.$$indexCreated&&void 0!=c.$$indexCreated.fieldName?o[c.$$indexCreated.fieldName]=c.$$indexCreated:"string"==typeof c.$$indexRemoved&&delete o[c.$$indexRemoved]}catch(t){u+=1}}if(n.length>0&&u/n.length>this.corruptAlertThreshold)throw new Error("More than "+Math.floor(100*this.corruptAlertThreshold)+"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NeDB to prevent dataloss");return Object.keys(r).forEach(function(t){i.push(r[t])}),{data:i,indexes:o}},r.prototype.loadDatabase=function(t){var e=t||function(){},n=this;if(n.db.resetIndexes(),n.inMemoryOnly)return e(null);c.waterfall([function(t){r.ensureDirectoryExists(u.dirname(n.filename),function(e){o.ensureDatafileIntegrity(n.filename,function(e){o.readFile(n.filename,"utf8",function(e,r){if(e)return t(e);try{var i=n.treatRawData(r)}catch(e){return t(e)}Object.keys(i.indexes).forEach(function(t){n.db.indexes[t]=new l(i.indexes[t])});try{n.db.resetIndexes(i.data)}catch(e){return n.db.resetIndexes(),t(e)}n.db.persistence.persistCachedDatabase(t)})})})}],function(t){return t?e(t):(n.db.executor.processBuffer(),e(null))})},e.exports=r},{"./customUtils":6,"./indexes":9,"./model":10,"./storage":12,__browserify_process:4,async:13,path:2}],12:[function(t,e,n){function r(t,e){console.log("in exists,filename:"+t),h.set("e"+f,e),atelier.plugin.exec("DatabasePlugin","exist","e"+f,t+""),f++}function i(t,e,n){console.log("in rename,filename:"+t),h.set("n"+f,n),atelier.plugin.exec("DatabasePlugin","rename","n"+f,t+" "+e),f++}function o(t,e,n,r){console.log("in writeFile,filename:"+t),console.log("contents:"),"function"==typeof n&&(r=n),h.set("w"+f,r),atelier.plugin.exec("DatabasePlugin","writeFile","w"+f,t+" "+e),f++}function u(t,e,n,r){console.log("in appendFile,filename:"+t),"function"==typeof n&&(r=n),h.set("a"+f,r),atelier.plugin.exec("DatabasePlugin","appendFile","a"+f,t+" "+e),f++}function a(t,e,n){console.log("in readFile,filename:"+t),"function"==typeof e&&(n=e),h.set("r"+f,n),atelier.plugin.exec("DatabasePlugin","readFile","r"+f,t+""),f++}function c(t,e){console.log("in unlink,filename:"+t),h.set("u"+f,e),atelier.plugin.exec("DatabasePlugin","unlink","u"+f,t+""),f++}function s(t,e){console.log("in mkdirp,filename:"+t),h.set("m"+f,e),atelier.plugin.exec("DatabasePlugin","mkdirp","m"+f,t+""),f++}function l(t,e){return e(null)}var f=0,h=new Map;atelier.plugin.onNativeMessage.addListener(function(t,e,n,r,i){console.log("in listener callbackId:"+t);var o=t.charAt(0),u=h.get(t);if(void 0==u)return void console.log("error:no such callback with callbackId:"+t);switch(h.delete(t),o){case"e":return u(e?!0:!1);case"n":case"w":case"a":return u();case"r":return console.log(r),u(null,r||"");case"u":return e?u():u(new Error("unlink failed"));case"m":return e?u():void 0}}),e.exports.exists=r,e.exports.rename=i,e.exports.writeFile=o,e.exports.crashSafeWriteFile=o,e.exports.appendFile=u,e.exports.readFile=a,e.exports.unlink=c,e.exports.mkdirp=s,e.exports.ensureDatafileIntegrity=l},{}],13:[function(e,n,i){var o=e("__browserify_process");!function(){function e(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(i,arguments)}}var i,u,a={};i=this,null!=i&&(u=i.async),a.noConflict=function(){return i.async=u,a};var c=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n+=1)e(t[n],n,t)},s=function(t,e){if(t.map)return t.map(e);var n=[];return c(t,function(t,r,i){n.push(e(t,r,i))}),n},l=function(t,e,n){return t.reduce?t.reduce(e,n):(c(t,function(t,r,i){n=e(n,t,r,i)}),n)},f=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};void 0!==o&&o.nextTick?(a.nextTick=o.nextTick,a.setImmediate=void 0!==r?function(t){r(t)}:a.nextTick):"function"==typeof r?(a.nextTick=function(t){r(t)},a.setImmediate=a.nextTick):(a.nextTick=function(t){setTimeout(t,0)},a.setImmediate=a.nextTick),a.each=function(t,n,r){if(r=r||function(){},!t.length)return r();var i=0;c(t,function(o){n(o,e(function(e){e?(r(e),r=function(){}):(i+=1)>=t.length&&r(null)}))})},a.forEach=a.each,a.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0;!function i(){e(t[r],function(e){e?(n(e),n=function(){}):(r+=1,r>=t.length?n(null):i())})}()},a.forEachSeries=a.eachSeries,a.eachLimit=function(t,e,n,r){h(e).apply(null,[t,n,r])},a.forEachLimit=a.eachLimit;var h=function(t){return function(e,n,r){if(r=r||function(){},!e.length||t<=0)return r();var i=0,o=0,u=0;!function a(){if(i>=e.length)return r();for(;u<t&&o<e.length;)o+=1,u+=1,n(e[o-1],function(t){t?(r(t),r=function(){}):(i+=1,u-=1,i>=e.length?r():a())})}()}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.each].concat(e))}},d=function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[h(t)].concat(n))}},y=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.eachSeries].concat(e))}},v=function(t,e,n,r){var i=[];e=s(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n,r){i[t.index]=r,e(n)})},function(t){r(t,i)})};a.map=p(v),a.mapSeries=y(v),a.mapLimit=function(t,e,n,r){return g(e)(t,n,r)};var g=function(t){return d(t,v)};a.reduce=function(t,e,n,r){a.eachSeries(t,function(t,r){n(e,t,function(t,n){e=n,r(t)})},function(t){r(t,e)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(t,e,n,r){var i=s(t,function(t){return t}).reverse();a.reduce(i,e,n,r)},a.foldr=a.reduceRight;var m=function(t,e,n,r){var i=[];e=s(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n&&i.push(t),e()})},function(t){r(s(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.filter=p(m),a.filterSeries=y(m),a.select=a.filter,a.selectSeries=a.filterSeries;var b=function(t,e,n,r){var i=[];e=s(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n||i.push(t),e()})},function(t){r(s(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.reject=p(b),a.rejectSeries=y(b);var w=function(t,e,n,r){t(e,function(t,e){n(t,function(n){n?(r(t),r=function(){}):e()})},function(t){r()})};a.detect=p(w),a.detectSeries=y(w),a.some=function(t,e,n){a.each(t,function(t,r){e(t,function(t){t&&(n(!0),n=function(){}),r()})},function(t){n(!1)})},a.any=a.some,a.every=function(t,e,n){a.each(t,function(t,r){e(t,function(t){t||(n(!1),n=function(){}),r()})},function(t){n(!0)})},a.all=a.every,a.sortBy=function(t,e,n){a.map(t,function(t,n){e(t,function(e,r){e?n(e):n(null,{value:t,criteria:r})})},function(t,e){if(t)return n(t);var r=function(t,e){var n=t.criteria,r=e.criteria;return n<r?-1:n>r?1:0};n(null,s(e.sort(r),function(t){return t.value}))})},a.auto=function(t,e){e=e||function(){};var n=f(t);if(!n.length)return e(null);var r={},i=[],o=function(t){i.unshift(t)},u=function(t){for(var e=0;e<i.length;e+=1)if(i[e]===t)return void i.splice(e,1)},s=function(){c(i.slice(0),function(t){t()})};o(function(){f(r).length===n.length&&(e(null,r),e=function(){})}),c(n,function(n){var i=t[n]instanceof Function?[t[n]]:t[n],h=function(t){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),t){var o={};c(f(r),function(t){o[t]=r[t]}),o[n]=i,e(t,o),e=function(){}}else r[n]=i,a.setImmediate(s)},p=i.slice(0,Math.abs(i.length-1))||[],d=function(){return l(p,function(t,e){return t&&r.hasOwnProperty(e)},!0)&&!r.hasOwnProperty(n)};if(d())i[i.length-1](h,r);else{o(function t(){d()&&(u(t),i[i.length-1](h,r))})}})},a.waterfall=function(t,e){if(e=e||function(){},t.constructor!==Array){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();!function t(n){return function(r){if(r)e.apply(null,arguments),e=function(){};else{var i=Array.prototype.slice.call(arguments,1),o=n.next();o?i.push(t(o)):i.push(e),a.setImmediate(function(){n.apply(null,i)})}}}(a.iterator(t))()};var x=function(t,e,n){if(n=n||function(){},e.constructor===Array)t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var r={};t.each(f(e),function(t,n){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[t]=i,n(e)})},function(t){n(t,r)})}};a.parallel=function(t,e){x({map:a.map,each:a.each},t,e)},a.parallelLimit=function(t,e,n){x({map:g(e),each:h(e)},t,n)},a.series=function(t,e){if(e=e||function(){},t.constructor===Array)a.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};a.eachSeries(f(t),function(e,r){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[e]=i,r(t)})},function(t){e(t,n)})}},a.iterator=function(t){return function e(n){var r=function e(){return t.length&&t[n].apply(null,arguments),e.next()};return r.next=function(){return n<t.length-1?e(n+1):null},r}(0)},a.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var k=function(t,e,n,r){var i=[];t(e,function(t,e){n(t,function(t,n){i=i.concat(n||[]),e(t)})},function(t){r(t,i)})};a.concat=p(k),a.concatSeries=y(k),a.whilst=function(t,e,n){t()?e(function(r){if(r)return n(r);a.whilst(t,e,n)}):n()},a.doWhilst=function(t,e,n){t(function(r){if(r)return n(r);e()?a.doWhilst(t,e,n):n()})},a.until=function(t,e,n){t()?n():e(function(r){if(r)return n(r);a.until(t,e,n)})},a.doUntil=function(t,e,n){t(function(r){if(r)return n(r);e()?n():a.doUntil(t,e,n)})},a.queue=function(t,n){function r(t,e,r,i){e.constructor!==Array&&(e=[e]),c(e,function(e){var o={data:e,callback:"function"==typeof i?i:null};r?t.tasks.unshift(o):t.tasks.push(o),t.saturated&&t.tasks.length===n&&t.saturated(),a.setImmediate(t.process)})}void 0===n&&(n=1);var i=0,o={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(t,e){r(o,t,!1,e)},unshift:function(t,e){r(o,t,!0,e)},process:function(){if(i<o.concurrency&&o.tasks.length){var n=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),i+=1;var r=function(){i-=1,n.callback&&n.callback.apply(n,arguments),o.drain&&o.tasks.length+i===0&&o.drain(),o.process()},u=e(r);t(n.data,u)}},length:function(){return o.tasks.length},running:function(){return i}};return o},a.cargo=function(t,e){var n=!1,r=[],i={tasks:r,payload:e,saturated:null,empty:null,drain:null,push:function(t,n){t.constructor!==Array&&(t=[t]),c(t,function(t){r.push({data:t,callback:"function"==typeof n?n:null}),i.saturated&&r.length===e&&i.saturated()}),a.setImmediate(i.process)},process:function o(){if(!n){if(0===r.length)return void(i.drain&&i.drain());var u="number"==typeof e?r.splice(0,e):r.splice(0),a=s(u,function(t){return t.data});i.empty&&i.empty(),n=!0,t(a,function(){n=!1;var t=arguments;c(u,function(e){e.callback&&e.callback.apply(null,t)}),o()})}},length:function(){return r.length},running:function(){return n}};return i};var _=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&c(n,function(e){console[t](e)}))}]))}};a.log=_("log"),a.dir=_("dir"),a.memoize=function(t,e){var n={},r={};e=e||function(t){return t};var i=function(){var i=Array.prototype.slice.call(arguments),o=i.pop(),u=e.apply(null,i);u in n?o.apply(null,n[u]):u in r?r[u].push(o):(r[u]=[o],t.apply(null,i.concat([function(){n[u]=arguments;var t=r[u];delete r[u];for(var e=0,i=t.length;e<i;e++)t[e].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=t,i},a.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},a.times=function(t,e,n){for(var r=[],i=0;i<t;i++)r.push(i);return a.map(r,e,n)},a.timesSeries=function(t,e,n){for(var r=[],i=0;i<t;i++)r.push(i);return a.mapSeries(r,e,n)},a.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var e=this,n=Array.prototype.slice.call(arguments),r=n.pop();a.reduce(t,n,function(t,n,r){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);r(t,e)}]))},function(t,n){r.apply(e,[t].concat(n))})}};var A=function(t,e){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return t(e,function(t,e){t.apply(n,r.concat([e]))},i)};if(arguments.length>2){return n.apply(this,Array.prototype.slice.call(arguments,2))}return n};a.applyEach=p(A),a.applyEachSeries=y(A),a.forever=function(t,e){function n(r){if(r){if(e)return e(r);throw r}t(n)}n()},void 0!==t&&t.amd?t([],function(){return a}):void 0!==n&&n.exports?n.exports=a:i.async=a}()},{__browserify_process:4}],14:[function(t,e,n){e.exports.BinarySearchTree=t("./lib/bst"),e.exports.AVLTree=t("./lib/avltree")},{"./lib/avltree":15,"./lib/bst":16}],15:[function(t,e,n){function r(t){this.tree=new i(t)}function i(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||u.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||u.defaultCheckValueEquality}var o=t("./bst"),u=t("./customUtils"),a=t("util");t("underscore");a.inherits(i,o),r._AVLTree=i,i.prototype.checkHeightCorrect=function(){var t,e;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(t=this.left?this.left.height:0,e=this.right?this.right.height:0,this.height!==1+Math.max(t,e))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},i.prototype.balanceFactor=function(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)},i.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},i.prototype.checkIsAVLT=function(){i.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},r.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},i.prototype.rightRotation=function(){var t,e,n,r,i=this,o=this.left;return o?(t=o.right,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.right=i,i.parent=o,i.left=t,t&&(t.parent=i),e=o.left?o.left.height:0,n=t?t.height:0,r=i.right?i.right.height:0,i.height=Math.max(n,r)+1,o.height=Math.max(e,i.height)+1,o):this},i.prototype.leftRotation=function(){var t,e,n,r,i=this,o=this.right;return o?(t=o.left,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.left=i,i.parent=o,i.right=t,t&&(t.parent=i),e=i.left?i.left.height:0,n=t?t.height:0,r=o.right?o.right.height:0,i.height=Math.max(e,n)+1,o.height=Math.max(r,i.height)+1,o):this},i.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},i.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},i.prototype.rebalanceAlongPath=function(t){var e,n,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(n=t.length-1;n>=0;n-=1)t[n].height=1+Math.max(t[n].left?t[n].left.height:0,t[n].right?t[n].right.height:0),t[n].balanceFactor()>1&&(e=t[n].rightTooSmall(),0===n&&(r=e)),t[n].balanceFactor()<-1&&(e=t[n].leftTooSmall(),0===n&&(r=e));return r},i.prototype.insert=function(t,e){var n=[],r=this;if(!this.hasOwnProperty("key"))return this.key=t,this.data.push(e),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,t)){if(r.unique){var i=new Error("Can't insert key "+t+", it violates the unique constraint");throw i.key=t,i.errorType="uniqueViolated",i}return r.data.push(e),this}if(n.push(r),r.compareKeys(t,r.key)<0){if(!r.left){n.push(r.createLeftChild({key:t,value:e}));break}r=r.left}else{if(!r.right){n.push(r.createRightChild({key:t,value:e}));break}r=r.right}}return this.rebalanceAlongPath(n)},r.prototype.insert=function(t,e){var n=this.tree.insert(t,e);n&&(this.tree=n)},i.prototype.delete=function(t,e){var n,r=[],i=this,o=[];if(!this.hasOwnProperty("key"))return this;for(;;){if(0===i.compareKeys(t,i.key))break;if(o.push(i),i.compareKeys(t,i.key)<0){if(!i.left)return this;i=i.left}else{if(!i.right)return this;i=i.right}}if(i.data.length>1&&void 0!==e)return i.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),i.data=r,this;if(!i.left&&!i.right)return i===this?(delete i.key,i.data=[],delete i.height,this):(i.parent.left===i?i.parent.left=null:i.parent.right=null,this.rebalanceAlongPath(o));if(!i.left||!i.right)return n=i.left?i.left:i.right,i===this?(n.parent=null,n):(i.parent.left===i?(i.parent.left=n,n.parent=i.parent):(i.parent.right=n,n.parent=i.parent),this.rebalanceAlongPath(o));if(o.push(i),n=i.left,!n.right)return i.key=n.key,i.data=n.data,i.left=n.left,n.left&&(n.left.parent=i),this.rebalanceAlongPath(o);for(;;){if(!n.right)break;o.push(n),n=n.right}return i.key=n.key,i.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(o)},r.prototype.delete=function(t,e){var n=this.tree.delete(t,e);n&&(this.tree=n)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(t){r.prototype[t]=function(){return this.tree[t].apply(this.tree,arguments)}}),e.exports=r},{"./bst":16,"./customUtils":17,underscore:18,util:3}],16:[function(t,e,n){function r(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||o.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||o.defaultCheckValueEquality}function i(t,e){var n;for(n=0;n<e.length;n+=1)t.push(e[n])}var o=t("./customUtils");r.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},r.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},r.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},r.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},r.prototype.checkAllNodesFullfillCondition=function(t){this.hasOwnProperty("key")&&(t(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(t),this.right&&this.right.checkAllNodesFullfillCondition(t))},r.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)>=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)<=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.right.checkNodeOrdering()))},r.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},r.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},r.prototype.getNumberOfKeys=function(){var t;return this.hasOwnProperty("key")?(t=1,this.left&&(t+=this.left.getNumberOfKeys()),this.right&&(t+=this.right.getNumberOfKeys()),t):0},r.prototype.createSimilar=function(t){return t=t||{},t.unique=this.unique,t.compareKeys=this.compareKeys,t.checkValueEquality=this.checkValueEquality,new this.constructor(t)},r.prototype.createLeftChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.left=e,e},r.prototype.createRightChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.right=e,e},r.prototype.insert=function(t,e){if(!this.hasOwnProperty("key"))return this.key=t,void this.data.push(e);if(0===this.compareKeys(this.key,t)){if(this.unique){var n=new Error("Can't insert key "+t+", it violates the unique constraint");throw n.key=t,n.errorType="uniqueViolated",n}return void this.data.push(e)}this.compareKeys(t,this.key)<0?this.left?this.left.insert(t,e):this.createLeftChild({key:t,value:e}):this.right?this.right.insert(t,e):this.createRightChild({key:t,value:e})},r.prototype.search=function(t){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,t)?this.data:this.compareKeys(t,this.key)<0?this.left?this.left.search(t):[]:this.right?this.right.search(t):[]:[]},r.prototype.getLowerBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$gt")||t.hasOwnProperty("$gte")?t.hasOwnProperty("$gt")&&t.hasOwnProperty("$gte")?0===e.compareKeys(t.$gte,t.$gt)?function(n){return e.compareKeys(n,t.$gt)>0}:e.compareKeys(t.$gte,t.$gt)>0?function(n){return e.compareKeys(n,t.$gte)>=0}:function(n){return e.compareKeys(n,t.$gt)>0}:t.hasOwnProperty("$gt")?function(n){return e.compareKeys(n,t.$gt)>0}:function(n){return e.compareKeys(n,t.$gte)>=0}:function(){return!0}},r.prototype.getUpperBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$lt")||t.hasOwnProperty("$lte")?t.hasOwnProperty("$lt")&&t.hasOwnProperty("$lte")?0===e.compareKeys(t.$lte,t.$lt)?function(n){return e.compareKeys(n,t.$lt)<0}:e.compareKeys(t.$lte,t.$lt)<0?function(n){return e.compareKeys(n,t.$lte)<=0}:function(n){return e.compareKeys(n,t.$lt)<0}:t.hasOwnProperty("$lt")?function(n){return e.compareKeys(n,t.$lt)<0}:function(n){return e.compareKeys(n,t.$lte)<=0}:function(){return!0}},r.prototype.betweenBounds=function(t,e,n){var r=[];return this.hasOwnProperty("key")?(e=e||this.getLowerBoundMatcher(t),n=n||this.getUpperBoundMatcher(t),e(this.key)&&this.left&&i(r,this.left.betweenBounds(t,e,n)),e(this.key)&&n(this.key)&&i(r,this.data),n(this.key)&&this.right&&i(r,this.right.betweenBounds(t,e,n)),r):[]},r.prototype.deleteIfLeaf=function(){return!this.left&&!this.right&&(this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0))},r.prototype.deleteIfOnlyOneChild=function(){var t;return this.left&&!this.right&&(t=this.left),!this.left&&this.right&&(t=this.right),!!t&&(this.parent?(this.parent.left===this?(this.parent.left=t,t.parent=this.parent):(this.parent.right=t,t.parent=this.parent),!0):(this.key=t.key,this.data=t.data,this.left=null,t.left&&(this.left=t.left,t.left.parent=this),this.right=null,t.right&&(this.right=t.right,t.right.parent=this),!0))},r.prototype.delete=function(t,e){var n,r=[],i=this;if(this.hasOwnProperty("key")){if(this.compareKeys(t,this.key)<0)return void(this.left&&this.left.delete(t,e));if(this.compareKeys(t,this.key)>0)return void(this.right&&this.right.delete(t,e));if(0!==!this.compareKeys(t,this.key))return this.data.length>1&&void 0!==e?(this.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),void(i.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.left=n.left,n.left&&(n.left.parent=n.parent)):(n.parent.right=n.left,n.left&&(n.left.parent=n.parent))):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.right=n.right,n.right&&(n.right.parent=n.parent)):(n.parent.left=n.right,n.right&&(n.right.parent=n.parent)))))}},r.prototype.executeOnEveryNode=function(t){this.left&&this.left.executeOnEveryNode(t),t(this),this.right&&this.right.executeOnEveryNode(t)},r.prototype.prettyPrint=function(t,e){e=e||"",console.log(e+"* "+this.key),t&&console.log(e+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(t,e+"  "):console.log(e+"  *"),this.right?this.right.prettyPrint(t,e+"  "):console.log(e+"  *"))},e.exports=r},{"./customUtils":17}],17:[function(t,e,n){function r(t){var e,n;return 0===t?[]:1===t?[0]:(e=r(t-1),n=Math.floor(Math.random()*t),e.splice(n,0,t-1),e)}function i(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;var n=new Error("Couldn't compare elements");throw n.a=t,n.b=e,n}function o(t,e){return t===e}e.exports.getRandomArray=r,e.exports.defaultCompareKeysFunction=i,e.exports.defaultCheckValueEquality=o},{}],18:[function(t,e,n){(function(){var t=this,r=t._,i={},o=Array.prototype,u=Object.prototype,c=Function.prototype,s=o.push,l=o.slice,f=o.concat,h=u.toString,p=u.hasOwnProperty,d=o.forEach,y=o.map,v=o.reduce,g=o.reduceRight,m=o.filter,b=o.every,w=o.some,x=o.indexOf,k=o.lastIndexOf,_=Array.isArray,A=Object.keys,O=c.bind,E=function t(e){return e instanceof t?e:this instanceof t?void(this._wrapped=e):new t(e)};void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=E),n._=E):t._=E,E.VERSION="1.4.4";var j=E.each=E.forEach=function(t,e,n){if(null!=t)if(d&&t.forEach===d)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;r<o;r++)if(e.call(n,t[r],r,t)===i)return}else for(var u in t)if(E.has(t,u)&&e.call(n,t[u],u,t)===i)return};E.map=E.collect=function(t,e,n){var r=[];return null==t?r:y&&t.map===y?t.map(e,n):(j(t,function(t,i,o){r[r.length]=e.call(n,t,i,o)}),r)};var $="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),v&&t.reduce===v)return r&&(e=E.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if(j(t,function(t,o,u){i?n=e.call(r,n,t,o,u):(n=t,i=!0)}),!i)throw new TypeError($);return n},E.reduceRight=E.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return r&&(e=E.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var u=E.keys(t);o=u.length}if(j(t,function(a,c,s){c=u?u[--o]:--o,i?n=e.call(r,n,t[c],c,s):(n=t[c],i=!0)}),!i)throw new TypeError($);return n},E.find=E.detect=function(t,e,n){var r;return S(t,function(t,i,o){if(e.call(n,t,i,o))return r=t,!0}),r},E.filter=E.select=function(t,e,n){var r=[];return null==t?r:m&&t.filter===m?t.filter(e,n):(j(t,function(t,i,o){e.call(n,t,i,o)&&(r[r.length]=t)}),r)},E.reject=function(t,e,n){return E.filter(t,function(t,r,i){return!e.call(n,t,r,i)},n)},E.every=E.all=function(t,e,n){e||(e=E.identity);var r=!0;return null==t?r:b&&t.every===b?t.every(e,n):(j(t,function(t,o,u){if(!(r=r&&e.call(n,t,o,u)))return i}),!!r)};var S=E.some=E.any=function(t,e,n){e||(e=E.identity);var r=!1;return null==t?r:w&&t.some===w?t.some(e,n):(j(t,function(t,o,u){if(r||(r=e.call(n,t,o,u)))return i}),!!r)};E.contains=E.include=function(t,e){return null!=t&&(x&&t.indexOf===x?-1!=t.indexOf(e):S(t,function(t){return t===e}))},E.invoke=function(t,e){var n=l.call(arguments,2),r=E.isFunction(e);return E.map(t,function(t){return(r?e:t[e]).apply(t,n)})},E.pluck=function(t,e){return E.map(t,function(t){return t[e]})},E.where=function(t,e,n){return E.isEmpty(e)?n?null:[]:E[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},E.findWhere=function(t,e){return E.where(t,e,!0)},E.max=function(t,e,n){if(!e&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&E.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return j(t,function(t,i,o){var u=e?e.call(n,t,i,o):t;u>=r.computed&&(r={value:t,computed:u})}),r.value},E.min=function(t,e,n){if(!e&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&E.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return j(t,function(t,i,o){var u=e?e.call(n,t,i,o):t;u<r.computed&&(r={value:t,computed:u})}),r.value},E.shuffle=function(t){var e,n=0,r=[];return j(t,function(t){e=E.random(n++),r[n-1]=r[e],r[e]=t}),r};var T=function(t){return E.isFunction(t)?t:function(e){return e[t]}};E.sortBy=function(t,e,n){var r=T(e);return E.pluck(E.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var D=function(t,e,n,r){var i={},o=T(e||E.identity);return j(t,function(e,u){var a=o.call(n,e,u,t);r(i,a,e)}),i};E.groupBy=function(t,e,n){return D(t,e,n,function(t,e,n){(E.has(t,e)?t[e]:t[e]=[]).push(n)})},E.countBy=function(t,e,n){return D(t,e,n,function(t,e){E.has(t,e)||(t[e]=0),t[e]++})},E.sortedIndex=function(t,e,n,r){n=null==n?E.identity:T(n);for(var i=n.call(r,e),o=0,u=t.length;o<u;){var a=o+u>>>1;n.call(r,t[a])<i?o=a+1:u=a}return o},E.toArray=function(t){return t?E.isArray(t)?l.call(t):t.length===+t.length?E.map(t,E.identity):E.values(t):[]},E.size=function(t){return null==t?0:t.length===+t.length?t.length:E.keys(t).length},E.first=E.head=E.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:l.call(t,0,e)},E.initial=function(t,e,n){return l.call(t,0,t.length-(null==e||n?1:e))},E.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},E.rest=E.tail=E.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},E.compact=function(t){return E.filter(t,E.identity)};var I=function t(e,n,r){return j(e,function(e){E.isArray(e)?n?s.apply(r,e):t(e,n,r):r.push(e)}),r};E.flatten=function(t,e){return I(t,e,[])},E.without=function(t){return E.difference(t,l.call(arguments,1))},E.uniq=E.unique=function(t,e,n,r){E.isFunction(e)&&(r=n,n=e,e=!1);var i=n?E.map(t,n,r):t,o=[],u=[];return j(i,function(n,r){(e?r&&u[u.length-1]===n:E.contains(u,n))||(u.push(n),o.push(t[r]))}),o},E.union=function(){return E.uniq(f.apply(o,arguments))},E.intersection=function(t){var e=l.call(arguments,1);return E.filter(E.uniq(t),function(t){return E.every(e,function(e){return E.indexOf(e,t)>=0})})},E.difference=function(t){var e=f.apply(o,l.call(arguments,1));return E.filter(t,function(t){return!E.contains(e,t)})},E.zip=function(){for(var t=l.call(arguments),e=E.max(E.pluck(t,"length")),n=new Array(e),r=0;r<e;r++)n[r]=E.pluck(t,""+r);return n},E.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},E.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=E.sortedIndex(t,e),t[r]===e?r:-1;r=n<0?Math.max(0,i+n):n}if(x&&t.indexOf===x)return t.indexOf(e,n);for(;r<i;r++)if(t[r]===e)return r;return-1},E.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(k&&t.lastIndexOf===k)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var i=r?n:t.length;i--;)if(t[i]===e)return i;return-1},E.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,o=new Array(r);i<r;)o[i++]=t,t+=n;return o},E.bind=function(t,e){if(t.bind===O&&O)return O.apply(t,l.call(arguments,1));var n=l.call(arguments,2);return function(){return t.apply(e,n.concat(l.call(arguments)))}},E.partial=function(t){var e=l.call(arguments,1);return function(){return t.apply(this,e.concat(l.call(arguments)))}},E.bindAll=function(t){var e=l.call(arguments,1);return 0===e.length&&(e=E.functions(t)),j(e,function(e){t[e]=E.bind(t[e],t)}),t},E.memoize=function(t,e){var n={};return e||(e=E.identity),function(){var r=e.apply(this,arguments);return E.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},E.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},E.defer=function(t){return E.delay.apply(E,[t,1].concat(l.call(arguments,1)))},E.throttle=function(t,e){var n,r,i,o,u=0,a=function(){u=new Date,i=null,o=t.apply(n,r)};return function(){var c=new Date,s=e-(c-u);return n=this,r=arguments,s<=0?(clearTimeout(i),i=null,u=c,o=t.apply(n,r)):i||(i=setTimeout(a,s)),o}},E.debounce=function(t,e,n){var r,i;return function(){var o=this,u=arguments,a=function(){r=null,n||(i=t.apply(o,u))},c=n&&!r;return clearTimeout(r),r=setTimeout(a,e),c&&(i=t.apply(o,u)),i}},E.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},E.wrap=function(t,e){return function(){var n=[t];return s.apply(n,arguments),e.apply(this,n)}},E.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},E.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},E.keys=A||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)E.has(t,n)&&(e[e.length]=n);return e},E.values=function(t){var e=[];for(var n in t)E.has(t,n)&&e.push(t[n]);return e},E.pairs=function(t){var e=[];for(var n in t)E.has(t,n)&&e.push([n,t[n]]);return e},E.invert=function(t){var e={};for(var n in t)E.has(t,n)&&(e[t[n]]=n);return e},E.functions=E.methods=function(t){var e=[];for(var n in t)E.isFunction(t[n])&&e.push(n);return e.sort()},E.extend=function(t){return j(l.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},E.pick=function(t){var e={},n=f.apply(o,l.call(arguments,1));return j(n,function(n){n in t&&(e[n]=t[n])}),e},E.omit=function(t){var e={},n=f.apply(o,l.call(arguments,1));for(var r in t)E.contains(n,r)||(e[r]=t[r]);return e},E.defaults=function(t){return j(l.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},E.clone=function(t){return E.isObject(t)?E.isArray(t)?t.slice():E.extend({},t):t},E.tap=function(t,e){return e(t),t};var M=function t(e,n,r,i){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return e===n;e instanceof E&&(e=e._wrapped),n instanceof E&&(n=n._wrapped);var o=h.call(e);if(o!=h.call(n))return!1;switch(o){case"[object String]":return e==String(n);case"[object Number]":return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if("object"!=(void 0===e?"undefined":a(e))||"object"!=(void 0===n?"undefined":a(n)))return!1;for(var u=r.length;u--;)if(r[u]==e)return i[u]==n;r.push(e),i.push(n);var c=0,s=!0;if("[object Array]"==o){if(c=e.length,s=c==n.length)for(;c--&&(s=t(e[c],n[c],r,i)););}else{var l=e.constructor,f=n.constructor;if(l!==f&&!(E.isFunction(l)&&l instanceof l&&E.isFunction(f)&&f instanceof f))return!1;for(var p in e)if(E.has(e,p)&&(c++,!(s=E.has(n,p)&&t(e[p],n[p],r,i))))break;if(s){for(p in n)if(E.has(n,p)&&!c--)break;s=!c}}return r.pop(),i.pop(),s};E.isEqual=function(t,e){return M(t,e,[],[])},E.isEmpty=function(t){if(null==t)return!0;if(E.isArray(t)||E.isString(t))return 0===t.length;for(var e in t)if(E.has(t,e))return!1;return!0},E.isElement=function(t){return!(!t||1!==t.nodeType)},E.isArray=_||function(t){return"[object Array]"==h.call(t)},E.isObject=function(t){return t===Object(t)},j(["Arguments","Function","String","Number","Date","RegExp"],function(t){E["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),E.isArguments(arguments)||(E.isArguments=function(t){return!(!t||!E.has(t,"callee"))}),E.isFunction=function(t){return"function"==typeof t},E.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},E.isNaN=function(t){return E.isNumber(t)&&t!=+t},E.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==h.call(t)},E.isNull=function(t){return null===t},E.isUndefined=function(t){return void 0===t},E.has=function(t,e){return p.call(t,e)},E.noConflict=function(){return t._=r,this},E.identity=function(t){return t},E.times=function(t,e,n){for(var r=Array(t),i=0;i<t;i++)r[i]=e.call(n,i);return r},E.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};F.unescape=E.invert(F.escape);var N={escape:new RegExp("["+E.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(F.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(t){E[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return F[t][e]})}}),E.result=function(t,e){if(null==t)return null;var n=t[e];return E.isFunction(n)?n.call(t):n},E.mixin=function(t){j(E.functions(t),function(e){var n=E[e]=t[e];E.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),z.call(this,n.apply(E,t))}})};var C=0;E.uniqueId=function(t){var e=++C+"";return t?t+e:e},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(t,e,n){var r;n=E.defaults({},n,E.templateSettings);var i=new RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(i,function(e,n,r,i,a){return u+=t.slice(o,a).replace(K,function(t){return"\\"+q[t]}),n&&(u+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),o=a+e.length,e}),u+="';\n",n.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{r=new Function(n.variable||"obj","_",u)}catch(t){throw t.source=u,t}if(e)return r(e,E);var a=function(t){return r.call(this,t,E)};return a.source="function("+(n.variable||"obj")+"){\n"+u+"}",a},E.chain=function(t){return E(t).chain()};var z=function(t){return this._chain?E(t).chain():t};E.mixin(E),j(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];E.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],z.call(this,n)}}),j(["concat","join","slice"],function(t){var e=o[t];E.prototype[t]=function(){return z.call(this,e.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],19:[function(e,n,r){(function(){function e(t){function e(e,n,r,i,o,u){for(;o>=0&&o<u;o+=t){var a=i?i[o]:o;r=n(r,e[a],a,e)}return r}return function(n,r,i,o){r=_(r,o,4);var u=!T(n)&&k.keys(n),a=(u||n).length,c=t>0?0:a-1;return arguments.length<3&&(i=n[u?u[c]:c],c+=t),e(n,r,i,u,c,a)}}function i(t){return function(e,n,r){n=A(n,r);for(var i=S(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}}function o(t,e,n){return function(r,i,o){var u=0,a=S(r);if("number"==typeof o)t>0?u=o>=0?o:Math.max(o+a,u):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return o=n(r,i),r[o]===i?o:-1;if(i!==i)return o=e(d.call(r,u,a),k.isNaN),o>=0?o+u:-1;for(o=t>0?u:a-1;o>=0&&o<a;o+=t)if(r[o]===i)return o;return-1}}function u(t,e){var n=N.length,r=t.constructor,i=k.isFunction(r)&&r.prototype||f,o="constructor";for(k.has(t,o)&&!k.contains(e,o)&&e.push(o);n--;)(o=N[n])in t&&t[o]!==i[o]&&!k.contains(e,o)&&e.push(o)}var c=this,s=c._,l=Array.prototype,f=Object.prototype,h=Function.prototype,p=l.push,d=l.slice,y=f.toString,v=f.hasOwnProperty,g=Array.isArray,m=Object.keys,b=h.bind,w=Object.create,x=function(){},k=function t(e){return e instanceof t?e:this instanceof t?void(this._wrapped=e):new t(e)};void 0!==r?(void 0!==n&&n.exports&&(r=n.exports=k),r._=k):c._=k,k.VERSION="1.8.3";var _=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},A=function(t,e,n){return null==t?k.identity:k.isFunction(t)?_(t,e,n):k.isObject(t)?k.matcher(t):k.property(t)};k.iteratee=function(t,e){return A(t,e,1/0)};var O=function(t,e){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],u=t(o),a=u.length,c=0;c<a;c++){var s=u[c];e&&void 0!==n[s]||(n[s]=o[s])}return n}},E=function(t){if(!k.isObject(t))return{};if(w)return w(t);x.prototype=t;var e=new x;return x.prototype=null,e},j=function(t){return function(e){return null==e?void 0:e[t]}},$=Math.pow(2,53)-1,S=j("length"),T=function(t){var e=S(t);return"number"==typeof e&&e>=0&&e<=$};k.each=k.forEach=function(t,e,n){e=_(e,n);var r,i;if(T(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=k.keys(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},k.map=k.collect=function(t,e,n){e=A(e,n);for(var r=!T(t)&&k.keys(t),i=(r||t).length,o=Array(i),u=0;u<i;u++){var a=r?r[u]:u;o[u]=e(t[a],a,t)}return o},k.reduce=k.foldl=k.inject=e(1),k.reduceRight=k.foldr=e(-1),k.find=k.detect=function(t,e,n){var r;if(void 0!==(r=T(t)?k.findIndex(t,e,n):k.findKey(t,e,n))&&-1!==r)return t[r]},k.filter=k.select=function(t,e,n){var r=[];return e=A(e,n),k.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},k.reject=function(t,e,n){return k.filter(t,k.negate(A(e)),n)},k.every=k.all=function(t,e,n){e=A(e,n);for(var r=!T(t)&&k.keys(t),i=(r||t).length,o=0;o<i;o++){var u=r?r[o]:o;if(!e(t[u],u,t))return!1}return!0},k.some=k.any=function(t,e,n){e=A(e,n);for(var r=!T(t)&&k.keys(t),i=(r||t).length,o=0;o<i;o++){var u=r?r[o]:o;if(e(t[u],u,t))return!0}return!1},k.contains=k.includes=k.include=function(t,e,n,r){return T(t)||(t=k.values(t)),("number"!=typeof n||r)&&(n=0),k.indexOf(t,e,n)>=0},k.invoke=function(t,e){var n=d.call(arguments,2),r=k.isFunction(e);return k.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},k.pluck=function(t,e){return k.map(t,k.property(e))},k.where=function(t,e){return k.filter(t,k.matcher(e))},k.findWhere=function(t,e){return k.find(t,k.matcher(e))},k.max=function(t,e,n){var r,i,o=-1/0,u=-1/0;if(null==e&&null!=t){t=T(t)?t:k.values(t);for(var a=0,c=t.length;a<c;a++)(r=t[a])>o&&(o=r)}else e=A(e,n),k.each(t,function(t,n,r){((i=e(t,n,r))>u||i===-1/0&&o===-1/0)&&(o=t,u=i)});return o},k.min=function(t,e,n){var r,i,o=1/0,u=1/0;if(null==e&&null!=t){t=T(t)?t:k.values(t);for(var a=0,c=t.length;a<c;a++)(r=t[a])<o&&(o=r)}else e=A(e,n),k.each(t,function(t,n,r){((i=e(t,n,r))<u||i===1/0&&o===1/0)&&(o=t,u=i)});return o},k.shuffle=function(t){for(var e,n=T(t)?t:k.values(t),r=n.length,i=Array(r),o=0;o<r;o++)e=k.random(0,o),e!==o&&(i[o]=i[e]),i[e]=n[o];return i},k.sample=function(t,e,n){return null==e||n?(T(t)||(t=k.values(t)),t[k.random(t.length-1)]):k.shuffle(t).slice(0,Math.max(0,e))},k.sortBy=function(t,e,n){return e=A(e,n),k.pluck(k.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var D=function(t){return function(e,n,r){var i={};return n=A(n,r),k.each(e,function(r,o){var u=n(r,o,e);t(i,r,u)}),i}};k.groupBy=D(function(t,e,n){k.has(t,n)?t[n].push(e):t[n]=[e]}),k.indexBy=D(function(t,e,n){t[n]=e}),k.countBy=D(function(t,e,n){k.has(t,n)?t[n]++:t[n]=1}),k.toArray=function(t){return t?k.isArray(t)?d.call(t):T(t)?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:T(t)?t.length:k.keys(t).length},k.partition=function(t,e,n){e=A(e,n);var r=[],i=[];return k.each(t,function(t,n,o){(e(t,n,o)?r:i).push(t)}),[r,i]},k.first=k.head=k.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:k.initial(t,t.length-e)},k.initial=function(t,e,n){return d.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},k.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:k.rest(t,Math.max(0,t.length-e))},k.rest=k.tail=k.drop=function(t,e,n){return d.call(t,null==e||n?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var I=function t(e,n,r,i){for(var o=[],u=0,a=i||0,c=S(e);a<c;a++){var s=e[a];if(T(s)&&(k.isArray(s)||k.isArguments(s))){n||(s=t(s,n,r));var l=0,f=s.length;for(o.length+=f;l<f;)o[u++]=s[l++]}else r||(o[u++]=s)}return o};k.flatten=function(t,e){return I(t,e,!1)},k.without=function(t){return k.difference(t,d.call(arguments,1))},k.uniq=k.unique=function(t,e,n,r){k.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=A(n,r));for(var i=[],o=[],u=0,a=S(t);u<a;u++){var c=t[u],s=n?n(c,u,t):c;e?(u&&o===s||i.push(c),o=s):n?k.contains(o,s)||(o.push(s),i.push(c)):k.contains(i,c)||i.push(c)}return i},k.union=function(){return k.uniq(I(arguments,!0,!0))},k.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=S(t);r<i;r++){var o=t[r];if(!k.contains(e,o)){for(var u=1;u<n&&k.contains(arguments[u],o);u++);u===n&&e.push(o)}}return e},k.difference=function(t){var e=I(arguments,!0,!0,1);return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){return k.unzip(arguments)},k.unzip=function(t){for(var e=t&&k.max(t,S).length||0,n=Array(e),r=0;r<e;r++)n[r]=k.pluck(t,r);return n},k.object=function(t,e){for(var n={},r=0,i=S(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},k.findIndex=i(1),k.findLastIndex=i(-1),k.sortedIndex=function(t,e,n,r){n=A(n,r,1);for(var i=n(e),o=0,u=S(t);o<u;){var a=Math.floor((o+u)/2);n(t[a])<i?o=a+1:u=a}return o},k.indexOf=o(1,k.findIndex,k.sortedIndex),k.lastIndexOf=o(-1,k.findLastIndex),k.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i};var M=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=E(t.prototype),u=t.apply(o,i);return k.isObject(u)?u:o};k.bind=function(t,e){if(b&&t.bind===b)return b.apply(t,d.call(arguments,1));if(!k.isFunction(t))throw new TypeError("Bind must be called on a function");var n=d.call(arguments,2);return function r(){return M(t,r,e,this,n.concat(d.call(arguments)))}},k.partial=function(t){var e=d.call(arguments,1);return function n(){for(var r=0,i=e.length,o=Array(i),u=0;u<i;u++)o[u]=e[u]===k?arguments[r++]:e[u];for(;r<arguments.length;)o.push(arguments[r++]);return M(t,n,this,this,o)}},k.bindAll=function(t){var e,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)n=arguments[e],t[n]=k.bind(t[n],t);return t},k.memoize=function(t,e){var n=function n(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return k.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},k.delay=function(t,e){var n=d.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},k.defer=k.partial(k.delay,k,1),k.throttle=function(t,e,n){var r,i,o,u=null,a=0;n||(n={});var c=function(){a=!1===n.leading?0:k.now(),u=null,o=t.apply(r,i),u||(r=i=null)};return function(){var s=k.now();a||!1!==n.leading||(a=s);var l=e-(s-a);return r=this,i=arguments,l<=0||l>e?(u&&(clearTimeout(u),u=null),a=s,o=t.apply(r,i),u||(r=i=null)):u||!1===n.trailing||(u=setTimeout(c,l)),o}},k.debounce=function(t,e,n){var r,i,o,u,a,c=function c(){var s=k.now()-u;s<e&&s>=0?r=setTimeout(c,e-s):(r=null,n||(a=t.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,u=k.now();var s=n&&!r;return r||(r=setTimeout(c,e)),s&&(a=t.apply(o,i),o=i=null),a}},k.wrap=function(t,e){return k.partial(e,t)},k.negate=function(t){return function(){return!t.apply(this,arguments)}},k.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},k.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},k.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},k.once=k.partial(k.before,2);var F=!{toString:null}.propertyIsEnumerable("toString"),N=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];k.keys=function(t){if(!k.isObject(t))return[];if(m)return m(t);var e=[];for(var n in t)k.has(t,n)&&e.push(n);return F&&u(t,e),e},k.allKeys=function(t){if(!k.isObject(t))return[];var e=[];for(var n in t)e.push(n);return F&&u(t,e),e},k.values=function(t){for(var e=k.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},k.mapObject=function(t,e,n){e=A(e,n);for(var r,i=k.keys(t),o=i.length,u={},a=0;a<o;a++)r=i[a],u[r]=e(t[r],r,t);return u},k.pairs=function(t){for(var e=k.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},k.invert=function(t){for(var e={},n=k.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},k.functions=k.methods=function(t){var e=[];for(var n in t)k.isFunction(t[n])&&e.push(n);return e.sort()},k.extend=O(k.allKeys),k.extendOwn=k.assign=O(k.keys),k.findKey=function(t,e,n){e=A(e,n);for(var r,i=k.keys(t),o=0,u=i.length;o<u;o++)if(r=i[o],e(t[r],r,t))return r},k.pick=function(t,e,n){var r,i,o={},u=t;if(null==u)return o;k.isFunction(e)?(i=k.allKeys(u),r=_(e,n)):(i=I(arguments,!1,!1,1),r=function(t,e,n){return e in n},u=Object(u));for(var a=0,c=i.length;a<c;a++){var s=i[a],l=u[s];r(l,s,u)&&(o[s]=l)}return o},k.omit=function(t,e,n){if(k.isFunction(e))e=k.negate(e);else{var r=k.map(I(arguments,!1,!1,1),String);e=function(t,e){return!k.contains(r,e)}}return k.pick(t,e,n)},k.defaults=O(k.allKeys,!0),k.create=function(t,e){var n=E(t);return e&&k.extendOwn(n,e),n},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t},k.isMatch=function(t,e){var n=k.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var u=n[o];if(e[u]!==i[u]||!(u in i))return!1}return!0};var C=function t(e,n,r,i){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return e===n;e instanceof k&&(e=e._wrapped),n instanceof k&&(n=n._wrapped);var o=y.call(e);if(o!==y.call(n))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n}var u="[object Array]"===o;if(!u){if("object"!=(void 0===e?"undefined":a(e))||"object"!=(void 0===n?"undefined":a(n)))return!1;var c=e.constructor,s=n.constructor;if(c!==s&&!(k.isFunction(c)&&c instanceof c&&k.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in n)return!1}r=r||[],i=i||[];for(var l=r.length;l--;)if(r[l]===e)return i[l]===n;if(r.push(e),i.push(n),u){if((l=e.length)!==n.length)return!1;for(;l--;)if(!t(e[l],n[l],r,i))return!1}else{var f,h=k.keys(e);if(l=h.length,k.keys(n).length!==l)return!1;for(;l--;)if(f=h[l],!k.has(n,f)||!t(e[f],n[f],r,i))return!1}return r.pop(),i.pop(),!0};k.isEqual=function(t,e){return C(t,e)},k.isEmpty=function(t){return null==t||(T(t)&&(k.isArray(t)||k.isString(t)||k.isArguments(t))?0===t.length:0===k.keys(t).length)},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=g||function(t){return"[object Array]"===y.call(t)},k.isObject=function(t){var e=void 0===t?"undefined":a(t);return"function"===e||"object"===e&&!!t},k.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){k["is"+t]=function(e){return y.call(e)==="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return k.has(t,"callee")}),"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":a(Int8Array))&&(k.isFunction=function(t){return"function"==typeof t||!1}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!==+t},k.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===y.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return null!=t&&v.call(t,e)},k.noConflict=function(){return c._=s,this},k.identity=function(t){return t},k.constant=function(t){return function(){return t}},k.noop=function(){},k.property=j,k.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},k.matcher=k.matches=function(t){return t=k.extendOwn({},t),function(e){return k.isMatch(e,t)}},k.times=function(t,e,n){var r=Array(Math.max(0,t));e=_(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},k.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},k.now=Date.now||function(){return(new Date).getTime()};var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},q=k.invert(P),K=function(t){var e=function(e){return t[e]},n="(?:"+k.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};k.escape=K(P),k.unescape=K(q),k.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),k.isFunction(r)?r.call(t):r};var z=0;k.uniqueId=function(t){var e=++z+"";return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\u2028|\u2029/g,V=function(t){return"\\"+L[t]};k.template=function(t,e,n){!e&&n&&(e=n),e=k.defaults({},e,k.templateSettings);var r=RegExp([(e.escape||B).source,(e.interpolate||B).source,(e.evaluate||B).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(e,n,r,u,a){return o+=t.slice(i,a).replace(R,V),i=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":u&&(o+="';\n"+u+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var u=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var a=function(t){return u.call(this,t,k)};return a.source="function("+(e.variable||"obj")+"){\n"+o+"}",a},k.chain=function(t){var e=k(t);return e._chain=!0,e};var U=function(t,e){return t._chain?k(e).chain():e};k.mixin=function(t){k.each(k.functions(t),function(e){var n=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return p.apply(t,arguments),U(this,n.apply(k,t))}})},k.mixin(k),k.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=l[t];k.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],U(this,n)}}),k.each(["concat","join","slice"],function(t){var e=l[t];k.prototype[t]=function(){return U(this,e.apply(this._wrapped,arguments))}}),k.prototype.value=function(){return this._wrapped},k.prototype.valueOf=k.prototype.toJSON=k.prototype.value,k.prototype.toString=function(){return""+this._wrapped},"function"==typeof t&&t.amd&&t("underscore",[],function(){return k})}).call(this)},{}]},{},[7])(7)})}).call(e,n(4).setImmediate)},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(0);!function(t){t.GeoBOS=t.GeoBOS||{},t.GeoBOS.datastore=t.GeoBOS.datastore||{};var e;t.GeoBOS.datastore.create=function(t){if("string"==typeof t)return e=new i({filename:t}),e.query=e.find,e;if("object"===(void 0===t?"undefined":r(t)))return e=new i(t),e.query=e.find,e;if(void 0==t)return e=new i(t),e.query=e.find,e;throw new Error("wrong args for create!!!")}}(window)},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function o(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function u(){y&&p&&(y=!1,p.length?d=p.concat(d):v=-1,d.length&&a())}function a(){if(!y){var t=i(u);y=!0;for(var e=d.length;e;){for(p=d,d=[];++v<e;)p&&p[v].run();v=-1,e=d.length}p=null,y=!1,o(t)}}function c(t,e){this.fun=t,this.array=e}function s(){}var l,f,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var p,d=[],y=!1,v=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new c(t,e)),1!==d.length||y||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=s,h.addListener=s,h.once=s,h.off=s,h.removeListener=s,h.removeAllListeners=s,h.emit=s,h.prependListener=s,h.prependOnceListener=s,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return s[c]=r,a(c),c++}function i(t){delete s[t]}function o(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function u(t){if(l)setTimeout(u,0,t);else{var e=s[t];if(e){l=!0;try{o(e)}finally{i(t),l=!1}}}}if(!t.setImmediate){var a,c=1,s={},l=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?function(){a=function(t){e.nextTick(function(){u(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&u(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),a=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){u(t.data)},a=function(e){t.port2.postMessage(e)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var t=f.documentElement;a=function(e){var n=f.createElement("script");n.onreadystatechange=function(){u(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){a=function(t){setTimeout(u,0,t)}}(),h.setImmediate=r,h.clearImmediate=i}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(5),n(2))},function(t,e,n){function r(t,e){this._id=t,this._clearFn=e}var i=Function.prototype.apply;e.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(3),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n}])});
