!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var t={};return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=0)}([function(e,r,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){e.GeoBOS=e.GeoBOS||{},e.GeoBOS.adhoc=function(){function e(e,r){if("function"!=typeof r||"object"!==(void 0===e?"undefined":n(e))||!e.type)return new Error("wrong param!");switch(e.type){case"001":l="CETC54Plugin";break;case"002":l="VoipPlugin";break;case"003":l="DTPlugin";break;case"004":l="CNIGC207Plugin";break;default:return new Error("wrong param!")}console.log("in init!"),m++,v.set(m+"",r),s(p.INIT,{pluginName:l,options:e,cbKey:m+""})}function r(e,r){return"function"!=typeof r?new Error("wrong param! param2 must be a function!"):l?(v.set(m+"",r),s(p.SETTER,{options:e,cbKey:m+""}),console.log("cbKey in setter: "+m),void m++):r(new Error("You should init first!"))}function t(e,r){return"function"!=typeof r?new Error("wrong param! param2 must be a function!"):l?(v.set(m+"",r),s(p.GETTER,{options:e,cbKey:m+""}),void m++):r(new Error("You should init first!"))}function o(e,r){return"function"!=typeof r?new Error("wrong param! param2 must be a function!"):l?(v.set(m+"",r),s(p.SENDMSG,{options:e,cbKey:m+""}),void m++):r(new Error("You should init first!"))}function a(e,r){return"function"!=typeof r?new Error("wrong param! param2 must be a function!"):l?(v.set(m+"",r),s(p.SENDFILE,{options:e,cbKey:m+""}),void m++):r(new Error("You should init first!"))}function i(e,r){return"function"!=typeof r?new Error("wrong param! param2 must be a function!"):l?(v.set(m+"",r),s(p.STARTPTT,{options:e,cbKey:m+""}),void m++):r(new Error("You should init first!"))}function c(e){return"function"!=typeof e?new Error("wrong param! param2 must be a function!"):l?(v.set(m+"",e),s(p.STOPPTT,{cbKey:m+""}),void m++):e(new Error("You should init first!"))}function s(e,r){var t={appid:E,uri:"",type:e,flags:"background",extras:r};atelier.appman.sendAction(t,u)}function u(e){var r=v.get(e.extras.cbKey);if(console.log("cbMap.size:"+v.size),console.log("result.extras.cbKey: "+e.extras.cbKey),r)e.extras.statusCode===y.SUCCESS?r():r(new Error(e.extras.msg)),v.delete(e.extras.cbKey),console.log("cbMap.size2:"+v.size),console.log("result.extras.cbKey2: "+e.extras.cbKey);else switch(e.extras.type){case p.REGISTER:b=!0;break;case p.UNREGISTER:b=!1}}function f(e){if(console.log(e),e.type)switch(e.type){case d.REPORT:var r=!0,t=!1,n=void 0;try{for(var o,a=S[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var i=o.value;console.log("-------\x3e"+e.extras.msg),i(e.extras.msg)}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}break;case d.RECVMSG:var c=!0,s=!1,u=void 0;try{for(var f,l=R[Symbol.iterator]();!(c=(f=l.next()).done);c=!0){(0,f.value)(e.extras.msg)}}catch(e){s=!0,u=e}finally{try{!c&&l.return&&l.return()}finally{if(s)throw u}}break;case d.RECVFILE:var p=!0,y=!1,E=void 0;try{for(var m,v=T[Symbol.iterator]();!(p=(m=v.next()).done);p=!0){(0,m.value)(e.extras.msg)}}catch(e){y=!0,E=e}finally{try{!p&&v.return&&v.return()}finally{if(y)throw E}}}}var l,p={INIT:"init",SETTER:"adhoc_send_cmd",GETTER:"adhoc_send_cmd",SENDMSG:"adhoc_send_message",SENDFILE:"adhoc_send_file",STARTPTT:"adhoc_start_ptt",STOPPTT:"adhoc_stop_ptt",REGISTER:"register",UNREGISTER:"unregister"},d={REPORT:"iecas_adhoc_recv_cmd",RECVFILE:"iecas_adhoc_recv_file",RECVMSG:"iecas_adhoc_recv_message"},y={SUCCESS:100,PARAM_ERROR:102,FAILED:200},E="com.iecas.totalserver",m=0,v=new Map,b=!1,w="",S=new Set,R=new Set,T=new Set,g=function(){var e,r;return e=function(e,r){if(console.log("in addlistener！"),"function"!=typeof r)throw new Error("param should be a function！");S.add(r),b||(w=e,s(p.REGISTER,{appId:w}))},r=function(e){if(e){if("function"!=typeof e)throw new Error("wrong param!");var r=!0,t=!1,n=void 0;try{for(var o,a=S[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var i=o.value;i===e&&(S.delete(i),0===S.size&&s(p.UNREGISTER,{appId:w}))}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}else S.clear(),s(p.UNREGISTER,{appId:w})},{addListener:e,removeListener:r}}(),h=function(){var e,r;return e=function(e,r){if("function"!=typeof r)throw new Error("param should be a function！");R.add(r),b||(w=e,s(p.REGISTER,{appId:w}))},r=function(e){if(e){if("function"!=typeof e)throw new Error("wrong param!");var r=!0,t=!1,n=void 0;try{for(var o,a=R[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var i=o.value;i===e&&(R.delete(i),0===R.size&&s(p.UNREGISTER,{appId:w}))}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}else R.clear(),s(p.UNREGISTER,{appId:w})},{addListener:e,removeListener:r}}(),I=function(){var e,r;return e=function(e,r){if("function"!=typeof r)throw new Error("param should be a function！");T.add(r),b||(w=e,s(p.REGISTER,{appId:w}))},r=function(e){if(e){if("function"!=typeof e)throw new Error("wrong param!");var r=!0,t=!1,n=void 0;try{for(var o,a=T[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var i=o.value;i===e&&(T.delete(i),0===T.size&&s(p.UNREGISTER,{appId:w}))}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}else T.clear(),s(p.UNREGISTER,{appId:w})},{addListener:e,removeListener:r}}();return atelier.appman.onAction.addListener(f),{init:e,setter:r,getter:t,sendMessage:o,sendFile:a,startPTT:i,stopPTT:c,onATMessage:g,onMessageReceived:h,onFileReceived:I}}()}(window)}])});